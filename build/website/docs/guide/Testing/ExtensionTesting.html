<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
                    <title>phpDocumentor</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@100;200;300;400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/template.js"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">phpDocumentor</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -three phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category">
            <h2 class="phpdocumentor-sidebar__category-header">typo3-explained</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Introduction/Index.html#introduction" class="">Introduction</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Introduction/Index.html#system-overview-1" class="">System Overview</a>
                
            </li>
                    <li>
                <a href="guide/Introduction/Index.html#a-basic-installation" class="">A basic installation</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ApiOverview/Index.html#api-a-z" class="">API A-Z</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/CodingGuidelines/Index.html#cgl" class="">Coding Guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/CodingGuidelines/Introduction.html#cgl-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglPhp/Index.html#cgl-php" class="">PHP Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglJavaScript/Index.html#cgl-javascript" class="">JavaScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypeScript/Index.html#cgl-typescript" class="">TypeScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypoScript/Index.html#cgl-typoscript" class="">TypoScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTsConfig.html#cgl-tsconfig" class="">TSconfig Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglXliff/Index.html#cgl-xliff" class="">Xliff Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglYaml.html#cgl-yaml" class="">Yaml Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglRest/Index.html#cgl-rest" class="">reStructuredText (reST)</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Configuration/Index.html#configuration" class="">Configuration</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Configuration/ConfigurationOverview.html#config-overview" class="">Configuration overview</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Glossary.html#configuration-classification" class="">Glossary</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationFiles.html#configuration-files" class="">Configuration files</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationModule/Index.html#configuration-module" class="">Configuration module</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/FeatureToggles.html#feature-toggles" class="">Feature toggles</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/GlobalVariables.html#globals-variables" class="">$GLOBALS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3ConfVars/Index.html#typo3-conf-vars" class="">TYPO3_CONF_VARS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3Information.html#typo3Information" class="">Global meta information about TYPO3</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Tsconfig.html#tsconfig" class="">TSconfig</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/TypoScriptSyntax/Index.html#typoscript-syntax-about" class="">TypoScript syntax</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/UserSettingsConfiguration/Index.html#user-settings" class="">User settings configuration</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Yaml/Index.html#yaml" class="">YAML</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ExtensionArchitecture/Index.html#extension-development" class="">Extension development</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/ExtensionArchitecture/Concepts/Index.html#extension-concepts" class="">Concepts</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/FileStructure/Index.html#extension-reserved-folders-legacy" class="">File structure</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/HowTo/Index.html#extension-howto" class="">Howto</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Extbase/Index.html#extbase" class="">Extbase</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/BestPractises/Index.html#extension-Best-practises" class="">Best practises and conventions</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Tutorials/Index.html#extension-tutorials" class="">Tutorials</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Security/Index.html#security" class="">Security guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Security/Introduction/Index.html#security-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/Security/SecurityTeam/Index.html#security-team" class="">The TYPO3 Security Team</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralInformation/Index.html#security-general-information" class="">General Information</a>
                
            </li>
                    <li>
                <a href="guide/Security/TypesOfThreats/Index.html#security-threats" class="">Types of Security Threats</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralGuidelines/Index.html#security-general-guidelines" class="">General guidelines</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesAdministrators/Index.html#security-administrators" class="">Guidelines for System Administrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesExtensionDevelopment/Index.html#security-extension-development" class="">Guidelines for extension development</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesIntegrators/Index.html#security-integrators" class="">Guidelines for TYPO3 integrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesEditors/Index.html#security-editors" class="">Guidelines for editors</a>
                
            </li>
                    <li>
                <a href="guide/Security/Backups/Index.html#security-backups" class="">Backup strategy</a>
                
            </li>
                    <li>
                <a href="guide/Security/HackedSite/Index.html#security-detect-analyze-repair" class="">Detect, analyze and repair a hacked site</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Testing/Index.html#testing" class="">Testing</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Testing/History.html#testing-history" class="">History</a>
                
            </li>
                    <li>
                <a href="guide/Testing/CoreTesting.html#testing-core" class="">Core testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ExtensionTesting.html#testing-extensions" class="">Extension testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ProjectTesting.html#testing-projects" class="">Project testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingUnit.html#testing-writing-unit" class="">Writing unit tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingFunctional.html#testing-writing-functional" class="">Writing functional tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingAcceptance.html#testing-writing-acceptance" class="">Writing acceptance tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/Faq.html#testing-faq" class="">FAQ</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/About.html#about" class="">About This Manual</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/About.html#intended-audience" class="">Intended Audience</a>
                
            </li>
                    <li>
                <a href="guide/About.html#code-examples-1" class="">Code examples</a>
                
            </li>
                    <li>
                <a href="guide/About.html#feedback-and-contribute" class="">Feedback and Contribute</a>
                
            </li>
                    <li>
                <a href="guide/About.html#credits-1" class="">Credits</a>
                
            </li>
                    <li>
                <a href="guide/About.html#dedication-1" class="">Dedication</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Sitemap.html#sitemap" class="">Sitemap</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/genindex.html#index" class="">Index</a>
</h4>

                        </section>
            
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                                        <section>
        
<div class="section" id="testing-extensions">
    <h1>Extension testing</h1>
            <dl>
                        <dt>The example in this chapter covers only outdated TYPO3 and PHP versions. Help us bring</dt>
        
        <dd><p>it up to dateh2document:contribute.</p><p>The general principles demonstrated here still apply.</p></dd>    </dl>
    </div>
<div class="section" id="introduction">
    <h1>Introduction</h1>
            <p>As an extension author, it is likely that you may want to test your extension during its development.
This chapter details how extension authors can set up automatic extension testing. We&#039;ll do that with
two examples. Both embed the given extension in a TYPO3 instance and run tests within this environment,
both examples also configure GitHub Actions to execute tests. We&#039;ll use Docker containers for test execution again and use
an extension specific runTests.sh script for executing test setup and execution.</p>
    </div>
<div class="section" id="scope">
    <h1>Scope</h1>
            <p>About this chapter and what it does <em>not</em> cover, first.</p>
            

<ul>
    <li><p>This documentation assumes an extension is tested with only one major Core version. It
does not support extension testing with multiple target Core versions. Extensions that
support multiple Core versions at the same time in the same branch are <em>not</em> scope of this document.
The Core Team encourages extension developers to have dedicated Core branches
per Core version. This has various advantages, it is for instance easy to create deprecation
free extensions this way.</p><p>If you need test setups for an extension that supports
multiple major Core versions at the same time, you may run into trouble if using
the <a href="https://github.com/TYPO3/testing-framework">typo3/testing-framework</a> package. The
development of that package is closely bound to Core development and has a relatively high
development speed. It does contain breaking patches per major Core versions, but it should
not contain breaking patches for existing major Core branches. If you now set up testing
using typo3/testing-framework with TYPO3 Core version 11, it should not break within v11&#039;s
lifetime. But it is likely to break if you upgrade to version 12 or later and may need adaption
in your extension codes or setup.</p><p>If you are looking for test setups that support multiple Core versions at once,
<a href="https://github.com/Nimut/testing-framework">nimut/testing-framework</a> may better suit your
needs. This is however out of scope for this chapter.</p></li>
    <li>This documentation relies on TYPO3 Core version 9 and higher. It is possible to
run tests using older Core versions and various extensions have done this before. This
is however out of scope for this chapter.</li>
    <li>We assume a Composer based setup. Extensions should provide a composer.json
file anyway and using Composer for extension testing is quite convenient.</li>
    <li>Similar to Core testing, this documentation relies on docker and docker-compose. See the
Core testing requirements for more details.</li>
    <li>We assume your extensions code is located within github and automatic testing is carried out using GitHub Actions.
The integration of GitHub Actions into github is easy to set up with plenty of documentation already available.
If your extensions code is located elsewhere or a different CI is used, this chapter may still be of use
in helping you build a general understanding of the testing process.</li>
</ul>
    </div>
<div class="section" id="general-strategy">
    <h1>General strategy</h1>
            <p>Third party extensions often rely on TYPO3 Core extensions to add key functionality.</p>
            <p>If a project needs a TYPO3 extension, it will add the required extension using composer require
to its own root composer.json file. The extensions composer.json then specifies additional detail, for
instance which PHP class namespaces it provides and where they can be found. This properly
integrates the extension into the project and the project then &quot;knows&quot; the location of extension
classes.</p>
            <p>If we want to test extension code directly, we do a similar changecomposer.json
file of the extension into a <a href="https://getcomposer.org/doc/04-schema.md#root-package">root composer.json file</a>.
That file then serves two needs at the same time: It is used by projects that require the extension
as a dependency and it is used as the root composer.json to specify dependencies turning the extension
into a project on its own for testing. The latter allows us to set up a full TYPO3
environment in a sub folder of the extension and execute the tests within this sub folder.</p>
    </div>
<div class="section" id="testing-enetcache">
    <h1>Testing enetcache</h1>
            <p>The extension <a href="https://github.com/lolli42/enetcache">enetcache</a> is a small extension that helps
with frontend plugin based caches. It has been available as composer package and a TER extension for quite
some time and is loosely maintained to keep up with current Core versions. At the time of
writing, it has three branches:</p>
            

<ul>
    <li>1.2 compatible with Core v7, released to TER as 1.x.y</li>
    <li>2 compatible with Core v8, released to TER as 2.x.y</li>
    <li>master compatible with Core v9, released to TER as 3.x.y</li>
</ul>
            <p>Branch master will be branched later as 3 when Core version 10 gains traction. This document
focuses on the master / Core v9 compatible branch. The extension comes with a couple of unit tests
in Tests/Unit, we want to run these locally and by GitHub Actions, along with some PHP linting to verify
there is no fatal PHP error. We&#039;ll test that extension with both PHP 7.2 and PHP 7.3 - the two PHP
versions TYPO3 Core v9 currently supports at the time of writing.</p>
            <div class="section" id="starting-point">
    <h2>Starting point</h2>
            <p>As outlined in the general strategy, we need to extend the existing composer.json file by
adding some root composer.json specific things. This does not harm the functionality of the existing
composer.json properties if the extension is a project dependency and not used as root composer.json:
Root properties are ignored in composer if the file is not used as root project file, see the
notes &quot;root-only&quot; of the <a href="https://getcomposer.org/doc/04-schema.md">composer documentation</a> for details.</p>
            <p>This is how the composer.json file looks before we add a test setup:</p>
            <pre><code class="language-json">{
  &quot;name&quot;: &quot;lolli/enetcache&quot;,
  &quot;type&quot;: &quot;typo3-cms-extension&quot;,
  &quot;description&quot;: &quot;Enetcache cache extension&quot;,
  &quot;homepage&quot;: &quot;https://github.com/lolli42/enetcache&quot;,
  &quot;authors&quot;: [
    {
      &quot;name&quot;: &quot;Christian Kuhn&quot;,
      &quot;role&quot;: &quot;Developer&quot;
    }
  ],
  &quot;license&quot;: [
    &quot;GPL-2.0-or-later&quot;
  ],
  &quot;require&quot;: {
    &quot;typo3/cms-core&quot;: &quot;^9.5&quot;
  },
  &quot;autoload&quot;: {
    &quot;psr-4&quot;: {
      &quot;Lolli\\Enetcache\\&quot;: &quot;Classes&quot;
    }
  },
  &quot;extra&quot;: {
    &quot;branch-alias&quot;: {
      &quot;dev-master&quot;: &quot;2.x-dev&quot;
    },
    &quot;typo3/cms&quot;: {
      &quot;cms-package-dir&quot;: &quot;{$vendor-dir}/typo3/cms&quot;
    }
  }
}</code></pre>
            <p>This is a typical composer.json file without any complexity: It&#039;s a typo3-cms-extension, with an
author and a license. We are stating that &quot;I need at least 9.5.0 of cms-core&quot; and we tell the auto loader
&quot;find all class names starting with Lolli\Enetcache in the Classes/ directory&quot;.</p>
            <p>The extension already contains some unit tests that extend typo3/testing-framework&#039;s base
unit test class in directory Tests/Unit/Hooks (stripped):</p>
            <pre><code class="language-php">&lt;?php
namespace Lolli\Enetcache\Tests\Unit\Hooks;

use TYPO3\TestingFramework\Core\Unit\UnitTestCase;

class DataHandlerFlushByTagHookTest extends UnitTestCase
{
    /**
     * @test
     */
    public function findReferencedDatabaseEntriesReturnsEmptyArrayForTcaWithoutRelations()
    {
        // some unit test code
    }
}</code></pre>
    </div>
            <div class="section" id="preparing-composer-json">
    <h2>Preparing composer.json</h2>
            <p>Now let&#039;s add our properties to put these tests into action. First, we add a series of properties to composer.json
to add root composer.json details, turning the extension into a project at the same time:</p>
            <pre><code class="language-json">{
  &quot;name&quot;: &quot;lolli/enetcache&quot;,
  &quot;type&quot;: &quot;typo3-cms-extension&quot;,
  &quot;description&quot;: &quot;Enetcache cache extension&quot;,
  &quot;homepage&quot;: &quot;https://github.com/lolli42/enetcache&quot;,
  &quot;authors&quot;: [
    {
      &quot;name&quot;: &quot;Christian Kuhn&quot;,
      &quot;role&quot;: &quot;Developer&quot;
    }
  ],
  &quot;license&quot;: [
    &quot;GPL-2.0-or-later&quot;
  ],
  &quot;require&quot;: {
    &quot;typo3/cms-core&quot;: &quot;^9.5&quot;
  },
  &quot;config&quot;: {
    &quot;vendor-dir&quot;: &quot;.Build/vendor&quot;,
    &quot;bin-dir&quot;: &quot;.Build/bin&quot;
  },
  &quot;require-dev&quot;: {
    &quot;typo3/testing-framework&quot;: &quot;^4.11.1&quot;
  },
  &quot;autoload&quot;: {
    &quot;psr-4&quot;: {
      &quot;Lolli\\Enetcache\\&quot;: &quot;Classes&quot;
    }
  },
  &quot;autoload-dev&quot;: {
    &quot;psr-4&quot;: {
      &quot;Lolli\\Enetcache\\Tests\\&quot;: &quot;Tests&quot;
    }
  },
  &quot;replace&quot;: {
    &quot;enetcache&quot;: &quot;self.version&quot;,
    &quot;typo3-ter/enetcache&quot;: &quot;self.version&quot;
  },
  &quot;scripts&quot;: {
    &quot;post-autoload-dump&quot;: [
      &quot;TYPO3\\TestingFramework\\Composer\\ExtensionTestEnvironment::prepare&quot;
    ]
  },
  &quot;extra&quot;: {
    &quot;branch-alias&quot;: {
      &quot;dev-master&quot;: &quot;2.x-dev&quot;
    },
    &quot;typo3/cms&quot;: {
      &quot;cms-package-dir&quot;: &quot;{$vendor-dir}/typo3/cms&quot;,
      &quot;extension-key&quot;: &quot;enetcache&quot;,
      &quot;web-dir&quot;: &quot;.Build/Web&quot;
    }
  }
}</code></pre>
            <p>Note all added properties are only used within our root composer.json files, they are ignored if the
extension is loaded as a dependency in our project. Note: We specify .Build as
build directory. This is where our TYPO3 instance will be set up. We add typo3/testing-framework
in a v9 compatible version as require-dev dependency. We add a autoload-dev to tell composer
that test classes are found in the Tests directory. In the scripts section we add a composer
hook. This one is interesting. That class of the testing framework links the main directory as
extension .Build/Web/typo3conf/ext/enetcache in our extension specific TYPO3 instance. It needs the
two additional properties web-dir and extension-key to do that.</p>
            <p>Now, before we start playing around with this setup, we instruct git to ignore runtime
on-the-fly files. The .gitignore looks like this:</p>
            <pre><code class="language-none">.Build/
.idea/
Build/testing-docker/.env
composer.lock</code></pre>
            <p>We ignore the entire .Build directory, these are on-the-fly files that do not belong to the extension
functionality. We also ignore the .idea directory - this is a directory where PhpStorm stores its settings.
We also ignore Build/testing-docker/.env - this is a test runtime file created by runTests.sh later.
And we ignore the composer.lock file: We don&#039;t specify our dependency versions and a
composer install will later always fetch for instance the youngest Core dependencies marked as
compatible in our composer.json file.</p>
            <p>Let&#039;s clone that repository and call composer install (stripped):</p>
            <pre><code class="language-shell">lolli@apoc /var/www/local/git $ git clone git@github.com:lolli42/enetcache.git
Cloning into &#039;enetcache&#039;...
X11 forwarding request failed on channel 0
remote: Enumerating objects: 76, done.
remote: Counting objects: 100% (76/76), done.
remote: Compressing objects: 100% (50/50), done.
remote: Total 952 (delta 34), reused 52 (delta 18), pack-reused 876
Receiving objects: 100% (952/952), 604.38 KiB | 1.48 MiB/s, done.
Resolving deltas: 100% (537/537), done.
lolli@apoc /var/www/local/git $ cd enetcache/
lolli@apoc /var/www/local/git/enetcache $ composer install
Loading composer repositories with package information
Updating dependencies (including require-dev)
Package operations: 75 installs, 0 updates, 0 removals
  - Installing typo3/cms-composer-installers (v2.2.1): Loading from cache
  ...
  - Installing typo3/testing-framework (4.11.1): Loading from cache
...
Writing lock file
Generating autoload files
Generating class alias map file
Inserting class alias loader into main autoload.php file
&gt; TYPO3\TestingFramework\Composer\ExtensionTestEnvironment::prepare
lolli@apoc /var/www/local/git/enetcache $</code></pre>
            <p>To clean up any errors created at this point, we can always run rm -r .Build/ composer.lock later and
call composer install again. We now have a basic TYPO3 instance in our .Build/ folder to execute
our tests in:</p>
            <pre><code class="language-shell">lolli@apoc /var/www/local/git/enetcache $ cd .Build/
lolli@apoc /var/www/local/git/enetcache/.Build $ ls
bin  vendor  Web
lolli@apoc /var/www/local/git/enetcache/.Build $ ls Web/
index.php  typo3  typo3conf
lolli@apoc /var/www/local/git/enetcache/.Build $ ls Web/typo3/sysext/
backend  Core  Extbase  fluid  frontend
lolli@apoc /var/www/local/git/enetcache/.Build $ ls -l Web/typo3conf/ext/
total 0
lrwxrwxrwx 1 lolli www-data 29 Nov  5 14:19 enetcache -&gt; /var/www/local/git/enetcache/</code></pre>
            <p>The package typo3/testing-framework that we added as require-dev dependency has some basic Core
extensions set as dependency, we end up with the Core extensions backend, core, extbase,
fluid and frontend in .Build/Web/typo3/sysext. Additionally, the
ExtensionTestEnvironment hook linked our git root checkout as extension into .Build/Web/typo3conf/ext.</p>
            <p>We now have a full TYPO3 instance. It is not installed, there is no database, but we are now at the point
to begin unit testing!</p>
    </div>
            <div class="section" id="runtests-sh-and-docker-compose-yml">
    <h2>runTests.sh and docker-compose.yml</h2>
            <p>Next we need to setup our tests. These are the two files we need: <a href="https://github.com/lolli42/enetcache/blob/master/Build/Scripts/runTests.sh">Build/Scripts/runTests.sh</a> and <a href="https://github.com/lolli42/enetcache/blob/master/Build/testing-docker/docker-compose.yml">Build/testing-docker/ docker-compose.yml</a>.</p>
            <p>These files are re-purposed from TYPO3&#039;s Core: <a href="https://github.com/typo3/typo3/blob/main/Build/Scripts/runTests.sh">core Build/Scripts/runTests.sh</a> and <a href="https://github.com/typo3/typo3/tree/main/Build/testing-docker/local/docker-compose.yml">core Build/testing-docker/local/ docker-compose.yml</a>. You can
copy and paste these files from extensions like enetcache or styleguide to your own extension, but you should then look
through the files and adapt to your needs, for example.</p>
            

<ul>
    <li>search for the word &quot;enetcache&quot; in runTests.sh and replace it with
your extension key.</li>
    <li>You may want to change the PHP_VERSION in runTests.sh to your minimally
supported PHP version. (You can also specify the version on the command line
using runTests.sh with -p.)</li>
</ul>
            <p>Let&#039;s run the tests:</p>
            <pre><code class="language-shell">lolli@apoc /var/www/local/git/enetcache $ Build/Scripts/runTests.sh
Creating network &quot;local_default&quot; with the default driver
PHP 7.2.11-3+ubuntu18.04.1+deb.sury.org+1 (cli) (built: Oct 25 2018 06:44:08) ( NTS )
PHPUnit 7.1.5 by Sebastian Bergmann and contributors.

.....SS                                                             7 / 7 (100%)

Time: 84 ms, Memory: 12.00MB

OK, but incomplete, skipped, or risky tests!
Tests: 7, Assertions: 56, Skipped: 2.
Removing local_unit_run_1 ... done
Removing network local_default</code></pre>
            <p>Done. That&#039;s it. Execution of your extension`s unit tests.</p>
            <p>If there is no test output, try changing the verbosity when you run runTests.sh:</p>
            <pre><code class="language-shell">enetcache&gt; Build/Scripts/runTests.sh -v</code></pre>
            <p>Use -h to see all options:</p>
            <pre><code class="language-shell">enetcache&gt; Build/Scripts/runTests.sh -h</code></pre>
            <p>On some versions of MacOS you might get the following error message when executing runTests.sh:</p>
            <pre><code class="language-shell">$ ./Build/Scripts/runTests.sh
readlink: illegal option -- f
usage: readlink [-n] [file ...]
Creating network &quot;local_default&quot; with the default driver
ERROR: Cannot create container for service unit: invalid volume specification: &#039;.:.:rw&#039;:
invalid mount config for type &quot;volume&quot;: invalid mount path: &#039;.&#039; mount path must be absolute
Removing network local_default</code></pre>
            <p>To solve this issue follow the steps described <a href="https://biercoff.com/fixing-readlink-illegal-option-f-error-on-a-mac/">here</a> to install greadlink which supports the needed --f option.</p>
            <p>Rather than changing the runTests.sh to then use greadlink and thus risk breaking your automated testing via GitHub Actions consider symlinking your readlink executable to the newly installed greadlink with the following command as mentioned in the comments:</p>
            <pre><code class="language-shell">ln -s &quot;$(which greadlink)&quot; &quot;$(dirname &quot;$(which greadlink)&quot;)/readlink&quot;</code></pre>
            <p>The runTests.sh file of enetcache comes with some additional features, for example it is possible to execute composer install from within a container using Build/Scripts/runTests.sh -s composerInstall, it is possible to execute unit tests with PHP 7.3 instead of 7.2 (option -p 7.3). This is available for PHP linting, too (-s lint). Similar to Core test execution it is possible to break point tests using xdebug (-x option), typo3gmbh containers
can be updated using runTests.sh -u, verbose output is available with -v and a help is available with runTests.sh -h. Have a look around.</p>
    </div>
            <div class="section" id="github-actions">
    <h2>Github Actions</h2>
            <p>With basic testing in place we now want automatic execution of tests whenever something is merged to the repository and if
people create pull requests for our extension, we want to make sure our carefully crafted test setup actually
works. We&#039;ll use the CI service of Github Actions to take care of
that. It&#039;s free for open source projects.
In order to tell the CI what to do, create a new workflow file in <a href="https://github.com/lolli42/enetcache/blob/master/.github/workflows/ci.yml">.github/workflows/ci.yml</a></p>
            <pre><code class="language-yaml">name: CI

on: [push, pull_request]

jobs:

  testsuite:
    name: all tests
    runs-on: ubuntu-latest
    strategy:
      matrix:
        php: [ &#039;7.2&#039;, &#039;7.3&#039;, &#039;7.4&#039; ]
        minMax: [ &#039;composerInstallMin&#039;, &#039;composerInstallMax&#039; ]
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Composer
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s ${{ matrix.minMax }}

      - name: Composer validate
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s composerValidate

      - name: Lint PHP
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s lint

      - name: Unit tests
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s unit

      - name: Functional tests with mariadb
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -d mariadb -s functional

      - name: Functional tests with postgres
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -d postgres -s functional

      - name: Functional tests with sqlite
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -d sqlite -s functional</code></pre>
            <p>In case of enetcache, we let Github Actions test the extension with the three PHP versions 7.2, 7.3 and 7.4.
Each of these PHP Versions will also be tested with the highest and lowest compatible dependencies (defined in strategy.matrix.minMax).
All defined steps run on the same checkout, so we will see six test runs in total, one per PHP version with each minMax property.
Each run will do a separate checkout, composer install first, then all the test and linting jobs we defined.
It&#039;s possible to see executed test runs <a href="https://github.com/lolli42/enetcache/actions">online</a>.
Green runTests.sh to actually run tests. So the environment our tests are executed in is
identical to our local environment. It&#039;s all dockerized. The environment provided by Github Actions is only used
to set up the docker environment.</p>
            <a id="testing-extensions-styleguide"></a>
    </div>
    </div>
<div class="section" id="testing-styleguide">
    <h1>Testing styleguide</h1>
            <p>The above enetcache extension is an example for a common extension that has few testing
needs: It just comes with a couple of unit and functional tests. Executing these and maybe adding PHP linting is recommended.
More ambitious testing needs additional effort. As an example, we pick the <a href="https://github.com/TYPO3/styleguide">styleguide</a> extension. This extension is developed &quot;core-near&quot;, Core itself
uses styleguide to test various FormEngine details with acceptance tests and if developing Core, that
extension is installed as a dependency by default. However, styleguide is just a casual extension: It is released
to composer&#039;s <a href="https://packagist.org/packages/typo3/cms-styleguide">packagist.org</a> and can be loaded as
dependency (or require-dev dependency) in any project.</p>
            <p>The styleguide extension follows the Core branching principle, too: At the time of this writing, its main
branch is dedicated to be compatible with upcoming Core version 11. There are branches compatible with older Core versions, too.</p>
            <p>In comparison to enetcache, styleguide comes with additional test suites: It has functional and
acceptance tests! Our goal is to run the functional tests with different database platforms, and to
execute the acceptance tests. Both locally and by GitHub Actions and with different PHP versions.</p>
            <div class="section" id="basic-setup">
    <h2>Basic setup</h2>
            <p>The setup is similar to what has been outlined in detail with enetcache above: We add properties to the
<a href="https://github.com/TYPO3/styleguide/blob/main/composer.json">composer.json</a> file to make it a valid
root composer.json defining a project. The require-dev section is a bit longer as we also
need <a href="https://codeception.com/">codeception</a> to run acceptance tests and specify a couple of additional
Core extensions for a basic TYPO3 instance. We additionally add an app-dir directive in the extra section.</p>
            <p>Next, we have another iteration of <a href="https://github.com/TYPO3/styleguide/blob/main/Build/Scripts/runTests.sh">runTests.sh</a>
and <a href="https://github.com/TYPO3/styleguide/blob/main/Build/testing-docker/docker-compose.yml">docker-compose.yml</a> that are
longer than the versions of enetcache to handle the functional and acceptance tests setups, too.</p>
            <p>With this in place we can run unit tests:</p>
            <pre><code class="language-shell">git clone git@github.com:TYPO3/styleguide.git
cd styleguide
Build/Scripts/runTests.sh -s composerInstall
# Run unit tests
Build/Scripts/runTests.sh
# ... OK (1 test, 4 assertions)</code></pre>
    </div>
            <div class="section" id="functional-testing">
    <h2>Functional testing</h2>
            <p>At the time writing, there is only a single functional test, but this one is important as
it tests crucial functionality within styleguide: The extension comes with several different TCA scenarios
to show all sorts of database relation and field possibilities supported within TYPO3. To simplify testing,
code can generate a page tree and demo data for all of these scenarios. Codewise, this is a huge
section of the extension and it uses quite some Core API to do its job. And yes, the generator breaks
once in a while. A perfect scenario for a <a href="https://github.com/TYPO3/styleguide/blob/main/Tests/Functional/TcaDataGenerator/GeneratorTest.php">functional test!</a>
(slightly stripped):</p>
            <pre><code class="language-php">&lt;?php
namespace TYPO3\CMS\Styleguide\Tests\Functional\TcaDataGenerator;

use TYPO3\CMS\Core\Core\Bootstrap;
use TYPO3\CMS\Styleguide\TcaDataGenerator\Generator;
use TYPO3\TestingFramework\Core\Functional\FunctionalTestCase;

/**
 * Test case
 */
class GeneratorTest extends FunctionalTestCase
{
    /**
     * @var array Have styleguide loaded
     */
    protected $testExtensionsToLoad = [
        &#039;typo3conf/ext/styleguide&#039;,
    ];

    /**
     * Just a dummy to show that at least one test is actually executed on mssql
     *
     * @test
     */
    public function dummy()
    {
        $this-&gt;assertTrue(true);
    }

    /**
     * @test
     * @group not-mssql
     * @todo Generator does not work using mssql DMBS yet ... fix this
     */
    public function generatorCreatesBasicRecord()
    {
        // styleguide generator uses DataHandler for some parts. DataHandler needs an
        // initialized BE user with admin right and the live workspace.
        Bootstrap::initializeBackendUser();
        $GLOBALS[&#039;BE_USER&#039;]-&gt;user[&#039;admin&#039;] = 1;
        $GLOBALS[&#039;BE_USER&#039;]-&gt;user[&#039;uid&#039;] = 1;
        $GLOBALS[&#039;BE_USER&#039;]-&gt;workspace = 0;
        Bootstrap::initializeLanguageObject();

        // Verify there is no tx_styleguide_elements_basic yet
        $queryBuilder = $this-&gt;getConnectionPool()-&gt;getQueryBuilderForTable(&#039;tx_styleguide_elements_basic&#039;);
        $queryBuilder-&gt;getRestrictions()-&gt;removeAll();
        $count = (int)$queryBuilder-&gt;count(&#039;uid&#039;)
            -&gt;from(&#039;tx_styleguide_elements_basic&#039;)
            -&gt;executeQuery()
            -&gt;fetchOne();
        $this-&gt;assertEquals(0, $count);

        $generator = new Generator();
        $generator-&gt;create();

        // Verify there is at least one tx_styleguide_elements_basic record now
        $queryBuilder = $this-&gt;getConnectionPool()-&gt;getQueryBuilderForTable(&#039;tx_styleguide_elements_basic&#039;);
        $queryBuilder-&gt;getRestrictions()-&gt;removeAll();
        $count = (int)$queryBuilder-&gt;count(&#039;uid&#039;)
            -&gt;from(&#039;tx_styleguide_elements_basic&#039;)
            -&gt;executeQuery()
            -&gt;fetchOne();
        $this-&gt;assertGreaterThan(0, $count);
    }
}</code></pre>
            <p>Ah, shame on us! The data generator does not work well if executed using MSSQL as our DBMS. It is thus marked as
@group not-mssql at the moment. We need to fix that at some point. The rest is rather straight forwardTYPO3\TestingFramework\Core\Functional\FunctionalTestCase, instruct it to load
the styleguide extension ($testExtensionsToLoad), need some additional magic for the DataHandler, then
call $generator-create(); and verify it created at least one record in one of our database tables.
That&#039;s it. It executes fine using runTests.sh:</p>
            <pre><code class="language-shell">lolli@apoc /var/www/local/git/styleguide $ Build/Scripts/runTests.sh -s functional
Creating network &quot;local_default&quot; with the default driver
Creating local_mariadb10_1 ... done
Waiting for database start...
Database is up
PHP 7.2.11-3+ubuntu18.04.1+deb.sury.org+1 (cli) (built: Oct 25 2018 06:44:08) ( NTS )
PHPUnit 7.1.5 by Sebastian Bergmann and contributors.

..                                                                  2 / 2 (100%)

Time: 5.23 seconds, Memory: 28.00MB

OK (2 tests, 3 assertions)
Stopping local_mariadb10_1 ... done
Removing local_functional_mariadb10_run_1 ... done
Removing local_mariadb10_1                ... done
Removing network local_default
lolli@apoc /var/www/local/git/styleguide $</code></pre>
            <p>The good thing about this test is that it actually triggers quite some functionality below. It does tons of
database inserts and updates and uses the Core DataHandler for various details. If something goes wrong in
this entire area, it would throw an exception, the functional test would recognize this and fail. But if
its green, we know that a large parts of that extension are working correctly.</p>
            <p>If looking at details - for instance if we try to fix the MSSQL issue - runTests.sh can be called with -x
again for xdebug break pointing. Also, the functional test execution becomes a bit funny: We are creating
a TYPO3 test instance within .Build/ folder anyway. But the functional test setup again creates instances
for the single tests cases. The code that is actually executed is now located in a sub folder
of typo3temp/ of .Build/, in this test case it is functional-9ad521a:</p>
            <pre><code class="language-shell">lolli@apoc /var/www/local/git/styleguide $ ls -l .Build/Web/typo3temp/var/tests/functional-9ad521a/
total 16
drwxr-sr-x 4 lolli www-data 4096 Nov  5 17:35 fileadmin
lrwxrwxrwx 1 lolli www-data   50 Nov  5 17:35 index.php -&gt; /var/www/local/git/styleguide/.Build/Web/index.php
lrwxrwxrwx 1 lolli www-data   46 Nov  5 17:35 typo3 -&gt; /var/www/local/git/styleguide/.Build/Web/typo3
drwxr-sr-x 4 lolli www-data 4096 Nov  5 17:35 typo3conf
lrwxrwxrwx 1 lolli www-data   40 Nov  5 17:35 typo3_src -&gt; /var/www/local/git/styleguide/.Build/Web
drwxr-sr-x 4 lolli www-data 4096 Nov  5 17:35 typo3temp
drwxr-sr-x 2 lolli www-data 4096 Nov  5 17:35 uploads</code></pre>
            <p>This can be confusing at first, but it starts making sense the more you use it.
Also, the docker-compose.yml file contains a setup to start needed databases for the functional tests
and runTests.sh is tuned to call the different scenarios.</p>
    </div>
            <div class="section" id="acceptance-testing">
    <h2>Acceptance testing</h2>
            <p>Not enough! The styleguide extension adds a module to the TYPO3 backend to the Topbar &gt; Help section.
Next to other things, this module adds buttons to create and delete the demo
data that has been functional tested above already. To verify this works in the backend as well, styleguide
comes with some straight acceptance tests in <a href="https://github.com/TYPO3/styleguide/blob/main/Tests/Acceptance/Backend/ModuleCest.php">Tests/Acceptance/Backend/ModuleCest</a>:</p>
            <pre><code class="language-php">&lt;?php
declare(strict_types = 1);
namespace TYPO3\CMS\Styleguide\Tests\Acceptance\Backend;

use TYPO3\CMS\Styleguide\Tests\Acceptance\Support\BackendTester;
use TYPO3\TestingFramework\Core\Acceptance\Helper\Topbar;

/**
 * Tests the styleguide backend module can be loaded
 */
class ModuleCest
{
    /**
     * Selector for the module container in the topbar
     *
     * @var string
     */
    public static $topBarModuleSelector = &#039;#typo3-cms-backend-backend-toolbaritems-helptoolbaritem&#039;;

    /**
     * @param BackendTester $I
     */
    public function _before(BackendTester $I)
    {
        $I-&gt;useExistingSession(&#039;admin&#039;);
    }

    /**
     * @param BackendTester $I
     */
    public function styleguideInTopbarHelpCanBeCalled(BackendTester $I)
    {
        $I-&gt;click(Topbar::$dropdownToggleSelector, self::$topBarModuleSelector);
        $I-&gt;canSee(&#039;Styleguide&#039;, self::$topBarModuleSelector);
        $I-&gt;click(&#039;Styleguide&#039;, self::$topBarModuleSelector);
        $I-&gt;switchToContentFrame();
        $I-&gt;see(&#039;TYPO3 CMS Backend Styleguide&#039;, &#039;h1&#039;);
    }

    /**
     * @depends styleguideInTopbarHelpCanBeCalled
     * @param BackendTester $I
     */
    public function creatingDemoDataWorks(BackendTester $I)
    {
        $I-&gt;click(Topbar::$dropdownToggleSelector, self::$topBarModuleSelector);
        $I-&gt;canSee(&#039;Styleguide&#039;, self::$topBarModuleSelector);
        $I-&gt;click(&#039;Styleguide&#039;, self::$topBarModuleSelector);
        $I-&gt;switchToContentFrame();
        $I-&gt;see(&#039;TYPO3 CMS Backend Styleguide&#039;, &#039;h1&#039;);
        $I-&gt;click(&#039;TCA / Records&#039;);
        $I-&gt;waitForText(&#039;TCA test records&#039;);
        $I-&gt;click(&#039;Create styleguide page tree with data&#039;);
        $I-&gt;waitForText(&#039;A page tree with styleguide TCA test records was created.&#039;, 300);
    }

    /**
     * @depends creatingDemoDataWorks
     * @param BackendTester $I
     */
    public function deletingDemoDataWorks(BackendTester $I)
    {
        $I-&gt;click(Topbar::$dropdownToggleSelector, self::$topBarModuleSelector);
        $I-&gt;canSee(&#039;Styleguide&#039;, self::$topBarModuleSelector);
        $I-&gt;click(&#039;Styleguide&#039;, self::$topBarModuleSelector);
        $I-&gt;switchToContentFrame();
        $I-&gt;see(&#039;TYPO3 CMS Backend Styleguide&#039;, &#039;h1&#039;);
        $I-&gt;click(&#039;TCA / Records&#039;);
        $I-&gt;waitForText(&#039;TCA test records&#039;);
        $I-&gt;click(&#039;Delete styleguide page tree and all styleguide data records&#039;);
        $I-&gt;waitForText(&#039;The styleguide page tree and all styleguide records were deleted.&#039;, 300);
    }
}</code></pre>
            <p>There are three tests: One verifies the backend module can be called, one creates demo data, the last
one deletes demo data again. The codeception setup needs a bit more attention to setup, though. The entry point
is the main <a href="https://github.com/TYPO3/styleguide/blob/main/Tests/codeception.yml">codeception.yml file</a>
extended by the <a href="https://github.com/TYPO3/styleguide/blob/main/Tests/Acceptance/Backend.suite.yml">backend suite</a>,
a <a href="https://github.com/TYPO3/styleguide/blob/main/Tests/Acceptance/Support/BackendTester.php">backend tester</a> and
a <a href="https://github.com/TYPO3/styleguide/blob/main/Tests/Acceptance/Support/Extension/BackendStyleguideEnvironment.php">codeception bootstrap extension</a>
that instructs the basic typo3/testing-framework acceptance bootstrap to load the styleguide extension and
have some database fixtures included to easily log in to the backend. Additionally, the runTests.sh and
docker-compose.yml files take care of adding selenium-chrome and a web server to actually execute the tests:</p>
            <pre><code class="language-shell">lolli@apoc /var/www/local/git/styleguide $ Build/Scripts/runTests.sh -s acceptance
Creating network &quot;local_default&quot; with the default driver
Creating local_chrome_1    ... done
Creating local_web_1       ... done
Creating local_mariadb10_1 ... done
Waiting for database start...
Database is up
Codeception PHP Testing Framework v2.5.1
Powered by PHPUnit 7.1.5 by Sebastian Bergmann and contributors.
Running with seed:


  Generating BackendTesterActions...

TYPO3\CMS\Styleguide\Tests\Acceptance\Support.Backend Tests (3) -------------------------------------------------------
Modules: WebDriver, \TYPO3\TestingFramework\Core\Acceptance\Helper\Acceptance, \TYPO3\TestingFramework\Core\Acceptance\Helper\Login, Asserts
-----------------------------------------------------------------------------------------------------------------------
 Recording  step-by-step screenshots will be saved to /var/www/local/git/styleguide/Tests/../.Build/Web/typo3temp/var/tests/AcceptanceReports/
Directory Format: record_5be078fb43f86_{filename}_{testname} ----

  Database Connection: {&quot;Connections&quot;:{&quot;Default&quot;:{&quot;driver&quot;:&quot;mysqli&quot;,&quot;dbname&quot;:&quot;func_test_at&quot;,&quot;host&quot;:&quot;mariadb10&quot;,&quot;user&quot;:&quot;root&quot;,&quot;password&quot;:&quot;funcp&quot;}}}
  Loaded Extensions: [&quot;core&quot;,&quot;extbase&quot;,&quot;fluid&quot;,&quot;backend&quot;,&quot;about&quot;,&quot;install&quot;,&quot;frontend&quot;,&quot;typo3conf/ext/styleguide&quot;]
ModuleCest: Styleguide in topbar help can be called

...

Time: 27.89 seconds, Memory: 28.00MB

OK (3 tests, 6 assertions)
Stopping local_mariadb10_1 ... done
Stopping local_chrome_1    ... done
Stopping local_web_1       ... done
Removing local_acceptance_backend_mariadb10_run_1 ... done
Removing local_mariadb10_1                        ... done
Removing local_chrome_1                           ... done
Removing local_web_1                              ... done
Removing network local_default</code></pre>
            <p>Ok, this setup is a bit more effort, but we end up with a browser automatically clicking things in
an ad-hoc TYPO3 instance to verify this extension can perform its job. If something goes wrong, screenshots
of the failed run can be found in .Build/Web/typo3temp/var/tests/AcceptanceReports/.</p>
    </div>
            <div class="section" id="github-actions">
    <h2>Github Actions</h2>
            <p>Now we want all of this automatically checked using Github Actions. As before, we define the jobs in <a href="https://github.com/TYPO3/styleguide/blob/main/.github/workflows/ci.yml">.github/workflows/ci.yml</a>:</p>
            <pre><code class="language-yaml">name: CI

on: [push, pull_request]

jobs:

  testsuite:
    name: all tests
    runs-on: ubuntu-latest
    strategy:
      matrix:
        php: [ &#039;7.2&#039;, &#039;7.3&#039;, &#039;7.4&#039; ]
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Install testing system
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s composerInstall

      - name: Composer validate
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s composerValidate

      - name: Lint PHP
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s lint

      - name: CGL
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s cgl

      - name: phpstan
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s phpstan

      - name: Unit Tests
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s unit

      - name: Functional Tests with mariadb
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -d mariadb -s functional

      - name: Functional Tests with postgres
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -d postgres -s functional

      - name: Functional Tests with sqlite
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -d sqlite -s functional

      - name: Acceptance Tests
        run: Build/Scripts/runTests.sh -p ${{ matrix.php }} -s acceptance</code></pre>
            <p>This is similar to the enetcache example, but does some more: The functional tests are executed
with three different DBMS (MariaDB, Postgres, sqlite), and the acceptance tests are executed, too.
This setup takes some time to complete on Github Actions. But, <a href="https://github.com/TYPO3/styleguide/actions">it&#039;s green</a>!</p>
    </div>
    </div>

    </section>
                            </div>
            <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
        </div>
        <a href="guide/Testing/ExtensionTesting.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>