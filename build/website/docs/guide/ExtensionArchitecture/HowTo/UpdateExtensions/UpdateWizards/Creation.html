<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
                    <title>phpDocumentor</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../../../../../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@100;200;300;400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/template.js"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">phpDocumentor</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -three phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category">
            <h2 class="phpdocumentor-sidebar__category-header">typo3-explained</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Introduction/Index.html#introduction" class="">Introduction</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Introduction/Index.html#system-overview-1" class="">System Overview</a>
                
            </li>
                    <li>
                <a href="guide/Introduction/Index.html#a-basic-installation" class="">A basic installation</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ApiOverview/Index.html#api-a-z" class="">API A-Z</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/CodingGuidelines/Index.html#cgl" class="">Coding Guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/CodingGuidelines/Introduction.html#cgl-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglPhp/Index.html#cgl-php" class="">PHP Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglJavaScript/Index.html#cgl-javascript" class="">JavaScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypeScript/Index.html#cgl-typescript" class="">TypeScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypoScript/Index.html#cgl-typoscript" class="">TypoScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTsConfig.html#cgl-tsconfig" class="">TSconfig Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglXliff/Index.html#cgl-xliff" class="">Xliff Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglYaml.html#cgl-yaml" class="">Yaml Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglRest/Index.html#cgl-rest" class="">reStructuredText (reST)</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Configuration/Index.html#configuration" class="">Configuration</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Configuration/ConfigurationOverview.html#config-overview" class="">Configuration overview</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Glossary.html#configuration-classification" class="">Glossary</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationFiles.html#configuration-files" class="">Configuration files</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationModule/Index.html#configuration-module" class="">Configuration module</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/FeatureToggles.html#feature-toggles" class="">Feature toggles</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/GlobalVariables.html#globals-variables" class="">$GLOBALS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3ConfVars/Index.html#typo3-conf-vars" class="">TYPO3_CONF_VARS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3Information.html#typo3Information" class="">Global meta information about TYPO3</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Tsconfig.html#tsconfig" class="">TSconfig</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/TypoScriptSyntax/Index.html#typoscript-syntax-about" class="">TypoScript syntax</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/UserSettingsConfiguration/Index.html#user-settings" class="">User settings configuration</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Yaml/Index.html#yaml" class="">YAML</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ExtensionArchitecture/Index.html#extension-development" class="">Extension development</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/ExtensionArchitecture/Concepts/Index.html#extension-concepts" class="">Concepts</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/FileStructure/Index.html#extension-reserved-folders-legacy" class="">File structure</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/HowTo/Index.html#extension-howto" class="">Howto</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Extbase/Index.html#extbase" class="">Extbase</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/BestPractises/Index.html#extension-Best-practises" class="">Best practises and conventions</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Tutorials/Index.html#extension-tutorials" class="">Tutorials</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Security/Index.html#security" class="">Security guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Security/Introduction/Index.html#security-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/Security/SecurityTeam/Index.html#security-team" class="">The TYPO3 Security Team</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralInformation/Index.html#security-general-information" class="">General Information</a>
                
            </li>
                    <li>
                <a href="guide/Security/TypesOfThreats/Index.html#security-threats" class="">Types of Security Threats</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralGuidelines/Index.html#security-general-guidelines" class="">General guidelines</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesAdministrators/Index.html#security-administrators" class="">Guidelines for System Administrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesExtensionDevelopment/Index.html#security-extension-development" class="">Guidelines for extension development</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesIntegrators/Index.html#security-integrators" class="">Guidelines for TYPO3 integrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesEditors/Index.html#security-editors" class="">Guidelines for editors</a>
                
            </li>
                    <li>
                <a href="guide/Security/Backups/Index.html#security-backups" class="">Backup strategy</a>
                
            </li>
                    <li>
                <a href="guide/Security/HackedSite/Index.html#security-detect-analyze-repair" class="">Detect, analyze and repair a hacked site</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Testing/Index.html#testing" class="">Testing</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Testing/History.html#testing-history" class="">History</a>
                
            </li>
                    <li>
                <a href="guide/Testing/CoreTesting.html#testing-core" class="">Core testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ExtensionTesting.html#testing-extensions" class="">Extension testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ProjectTesting.html#testing-projects" class="">Project testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingUnit.html#testing-writing-unit" class="">Writing unit tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingFunctional.html#testing-writing-functional" class="">Writing functional tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingAcceptance.html#testing-writing-acceptance" class="">Writing acceptance tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/Faq.html#testing-faq" class="">FAQ</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/About.html#about" class="">About This Manual</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/About.html#intended-audience" class="">Intended Audience</a>
                
            </li>
                    <li>
                <a href="guide/About.html#code-examples-1" class="">Code examples</a>
                
            </li>
                    <li>
                <a href="guide/About.html#feedback-and-contribute" class="">Feedback and Contribute</a>
                
            </li>
                    <li>
                <a href="guide/About.html#credits-1" class="">Credits</a>
                
            </li>
                    <li>
                <a href="guide/About.html#dedication-1" class="">Dedication</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Sitemap.html#sitemap" class="">Sitemap</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/genindex.html#index" class="">Index</a>
</h4>

                        </section>
            
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                                        <section>
        
<div class="section" id="creating-upgrade-wizards">
    <h1>Creating upgrade wizards</h1>
            <dl>
                        <dt>The registration of an upgrade wizard has changed in TYPO3 v12.2. An</dt>
        
        <dd>upgrade wizard class is now registered with an attribute. The
getIdentifier() method in the UpgradeWizardInterface
was removed. The registration via
$GLOBALS['TYPO3_CONF_VARS']['SC_OPTIONS']['ext/install']['update']
in ext_localconf.php is deprecated and will be removed in TYPO3 v13.
To be compatible with TYPO3 v11 and v12 you can still
use the registration via
ext_localconf.php.</dd>    </dl>
            <p>To create an upgrade wizard you have to add a class which implements the
UpgradeWizardInterface.</p>
            <p>The class <em>may</em> implement other interfaces (optional):</p>
            

<ul>
    <li>RepeatableInterface to not mark the wizard
as done after execution</li>
    <li>ChattyInterface for generating
output</li>
    <li>ConfirmableInferface for wizards that need user confirmation</li>
</ul>
            <a id="upgrade-wizards-register"></a>
            <a id="upgrade-wizards-interface"></a>
    </div>
<div class="section" id="upgradewizardinterface">
    <h1>UpgradeWizardInterface</h1>
            <p>Each upgrade wizard consists of a single PHP file containing a single PHP class.
This class has to implement TYPO3\CMS\Install\Updates\UpgradeWizardInterface
and its methods.</p>
            <p>The registration of an upgrade wizard is done directly in the class by adding
the class attribute \TYPO3\CMS\Install\Attribute\UpgradeWizard. The
unique identifier is passed as an argument.</p>
            <p>:caption: <a href="EXT:my_extension/Classes/Upgrades/ExampleUpgradeWizard.php">EXT:my_extension/Classes/Upgrades/ExampleUpgradeWizard.php</a></p>
            <dl>
                        <dt>Method getTitle()</dt>
        
        <dd>Return the speaking name of this wizard.</dd>                        <dt>Method getDescription()</dt>
        
        <dd>Return the description for this wizard.</dd>                        <dt>Method executeUpdate()</dt>
        
        <dd>Is called, if the user triggers the wizard. This method should contain, or
call, the code that is needed to execute the upgrade. Therefore, a boolean
has to be returned.</dd>                        <dt>Method updateNecessary()</dt>
        
        <dd>Is called to check whether the upgrade wizard has to run. Return
true, if an upgrade is necessary, false if not. If
false is returned, the upgrade wizard will not be displayed in the
list of available wizards.</dd>                        <dt>Method getPrerequisites()</dt>
        
        <dd><p>Returns an array of class names of prerequisite classes. This way, a wizard
can define dependencies before it can be performed. Currently, the following
prerequisites exist:</p>

<ul>
    <li>DatabaseUpdatedPrerequisite:
Ensures that the database table fields are up-to-date.</li>
    <li>ReferenceIndexUpdatedPrerequisite:
The reference index needs to be up-to-date.</li>
</ul><pre><code class="language-php">use TYPO3\CMS\Install\Updates\DatabaseUpdatedPrerequisite;
use TYPO3\CMS\Install\Updates\ReferenceIndexUpdatedPrerequisite;

/**
 * @return string[]
 */
public function getPrerequisites(): array
{
    return [
        DatabaseUpdatedPrerequisite::class,
        ReferenceIndexUpdatedPrerequisite::class,
    ];
}</code></pre></dd><dd></dd>    </dl>
            <a id="upgrade-wizards-identifier"></a>
    </div>
<div class="section" id="wizard-identifier">
    <h1>Wizard identifier</h1>
            <p>The wizard identifier is used:</p>
            

<ul>
    <li>when calling the wizard from the command line.</li>
    <li>when marking the wizard as done in the table sys_registry</li>
</ul>
            <p>Since all upgrade wizards of TYPO3 Core and extensions are registered using the
identifier, it is recommended to prepend the wizard identifier with a prefix
based on the extension key.</p>
            <p>You <strong>should</strong> use the following naming convention for the identifier:</p>
            <p>myExtension_wizardName, for example bootstrapPackage_addNewDefaultTypes</p>
            

<ul>
    <li>The extension key and wizard name in lowerCamelCase, separated by underscore</li>
    <li>The existing underscores in extension keys are replaced by capitalizing the
following letter</li>
</ul>
            <dl>
                        <dt>Any identifier will still work, using these naming conventions is not</dt>
        
        <dd>enforced. In fact, it is not recommended to change already existing wizard
identifierssys_registry table and this information
would then be lost.</dd>    </dl>
            <p>Some examples:</p>
            <table>
            <thead>
                            <tr>
                                            <th>Extension key</th>
                                            <th>Wizard identifier</th>
                                    </tr>
                    </thead>
    
    <tbody>
                    <tr>
                                    <td>container</td>
                                    <td>container_upgradeColumnPositions</td>
                            </tr>
                    <tr>
                                    <td>news_events</td>
                                    <td>newsEvents_migrateEvents</td>
                            </tr>
                    <tr>
                                    <td>bootstrap_package</td>
                                    <td>bootstrapPackage_addNewDefaultTypes</td>
                            </tr>
                    <tr>
                                    <td colspan="2">. indexinstall/Classes/Updates/RepeatableInterface.php h
his interface works as a marker and does not force any me
mplemented.
. indexChattyInterface can be implemented for wizards
utput. install/Classes/Updates/ChattyInterface.ph
nterfaceOutputInterface<a href="guide/ExtensionArchitecture/HowTo/UpdateExtensions/UpdateWizards/Creation.html#index91a1000bac5f9629016a0cbbdd5427633d30ce82-h-his-interface-works-as-a-marker-and-does-not-force-any-me-mplemented-index8b8bf31d96d7281dab45e68d351def2587389ed4-can-be-implemented-for-wizards-utput-abb3597b17b66452b3379fc8bae0b87f0de95c88outputinterface">. index91a1000bac5f9629016a0cbbdd5427633d30ce82 h his interface works as a marker and does not force any me mplemented. . index8b8bf31d96d7281dab45e68d351def2587389ed4 can be implemented for wizards utput. abb3597b17b66452b3379fc8bae0b87f0de95c88OutputInterface</a>.
. _OutputInterfaceinstall/Classes/Updates/DatabaseUpdatedP
mplements this interface. We are showing a simplified exa
his class:
.  code-block:: php
:caption: EXT:install/Classes/Updates/DatabaseUpdatedP
:emphasize-lines: 8,10-13,20
use Symfony\Component\Console\Output\OutputInterface;
class DatabaseUpdatedPrerequisite implements Prerequis
{
/**
* @var OutputInterface
*/
protected $output;
public function setOutput(OutputInterface $output)
{
$this-output = $output;
}
public function ensure(): bool
{
$adds = $this-upgradeWizardsService-getBlock
$result = null;
if (count($adds)  0) {
$this-output-writeln('Performing ' . cou
$result = $this-upgradeWizardsService-ad
}
return $result === null;
}
// ... more logic
}
.  index:: Upgrade wizards; Execution
.  _upgrade_wizard_execute:
xecuting the wizard
===================
izards are listed in the backend module :guilabel:Admin
he card Upgrade Wizard. The registered wizard
here, as long as it is not done.
t is also possible to execute the wizard from the command
.  tabs::
..  group-tab:: Composer-based installation
..  code-block:: bash
vendor/bin/typo3 <a href="upgrade:run">upgrade:run</a> myExtension_examp
.. group-tab:: Legacy installation
.. code-block:: bash
typo3/sysext/core/bin/typo3 <a href="upgrade:run">upgrade:run</a> myExte
.  tip::
Some existing wizards use the convention of using the
name as identifier. You may have to quote the backslas
for example:
..  tabs::
..  group-tab:: Composer-based installation
..  code-block:: bash
vendor/bin/typo3 <a href="upgrade:run">upgrade:run</a> &#039;\MyVendor\
.. group-tab:: Legacy installation
.. code-block:: bash
typo3/sysext/core/bin/typo3 &#039;\MyVendor\M
.  seealso::
You can find more information about running upgrade wi
:ref:`Upgrade wizard section &lt;<a href="t3install:use-the-upgrad">t3install:use-the-upgrad</a>
Installation Guide.</td>
                            </tr>
            </tbody>
</table>
    </div>

    </section>
                            </div>
            <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
        </div>
        <a href="guide/ExtensionArchitecture/HowTo/UpdateExtensions/UpdateWizards/Creation.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>