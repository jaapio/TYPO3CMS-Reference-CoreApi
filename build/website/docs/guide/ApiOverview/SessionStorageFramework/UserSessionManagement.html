<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
                    <title>phpDocumentor</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../../../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@100;200;300;400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/template.js"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">phpDocumentor</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -three phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category">
            <h2 class="phpdocumentor-sidebar__category-header">typo3-explained</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Introduction/Index.html#introduction" class="">Introduction</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Introduction/Index.html#system-overview-1" class="">System Overview</a>
                
            </li>
                    <li>
                <a href="guide/Introduction/Index.html#a-basic-installation" class="">A basic installation</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ApiOverview/Index.html#api-a-z" class="">API A-Z</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/CodingGuidelines/Index.html#cgl" class="">Coding Guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/CodingGuidelines/Introduction.html#cgl-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglPhp/Index.html#cgl-php" class="">PHP Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglJavaScript/Index.html#cgl-javascript" class="">JavaScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypeScript/Index.html#cgl-typescript" class="">TypeScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypoScript/Index.html#cgl-typoscript" class="">TypoScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTsConfig.html#cgl-tsconfig" class="">TSconfig Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglXliff/Index.html#cgl-xliff" class="">Xliff Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglYaml.html#cgl-yaml" class="">Yaml Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglRest/Index.html#cgl-rest" class="">reStructuredText (reST)</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Configuration/Index.html#configuration" class="">Configuration</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Configuration/ConfigurationOverview.html#config-overview" class="">Configuration overview</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Glossary.html#configuration-classification" class="">Glossary</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationFiles.html#configuration-files" class="">Configuration files</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationModule/Index.html#configuration-module" class="">Configuration module</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/FeatureToggles.html#feature-toggles" class="">Feature toggles</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/GlobalVariables.html#globals-variables" class="">$GLOBALS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3ConfVars/Index.html#typo3-conf-vars" class="">TYPO3_CONF_VARS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3Information.html#typo3Information" class="">Global meta information about TYPO3</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Tsconfig.html#tsconfig" class="">TSconfig</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/TypoScriptSyntax/Index.html#typoscript-syntax-about" class="">TypoScript syntax</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/UserSettingsConfiguration/Index.html#user-settings" class="">User settings configuration</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Yaml/Index.html#yaml" class="">YAML</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ExtensionArchitecture/Index.html#extension-development" class="">Extension development</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/ExtensionArchitecture/Concepts/Index.html#extension-concepts" class="">Concepts</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/FileStructure/Index.html#extension-reserved-folders-legacy" class="">File structure</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/HowTo/Index.html#extension-howto" class="">Howto</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Extbase/Index.html#extbase" class="">Extbase</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/BestPractises/Index.html#extension-Best-practises" class="">Best practises and conventions</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Tutorials/Index.html#extension-tutorials" class="">Tutorials</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Security/Index.html#security" class="">Security guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Security/Introduction/Index.html#security-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/Security/SecurityTeam/Index.html#security-team" class="">The TYPO3 Security Team</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralInformation/Index.html#security-general-information" class="">General Information</a>
                
            </li>
                    <li>
                <a href="guide/Security/TypesOfThreats/Index.html#security-threats" class="">Types of Security Threats</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralGuidelines/Index.html#security-general-guidelines" class="">General guidelines</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesAdministrators/Index.html#security-administrators" class="">Guidelines for System Administrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesExtensionDevelopment/Index.html#security-extension-development" class="">Guidelines for extension development</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesIntegrators/Index.html#security-integrators" class="">Guidelines for TYPO3 integrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesEditors/Index.html#security-editors" class="">Guidelines for editors</a>
                
            </li>
                    <li>
                <a href="guide/Security/Backups/Index.html#security-backups" class="">Backup strategy</a>
                
            </li>
                    <li>
                <a href="guide/Security/HackedSite/Index.html#security-detect-analyze-repair" class="">Detect, analyze and repair a hacked site</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Testing/Index.html#testing" class="">Testing</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Testing/History.html#testing-history" class="">History</a>
                
            </li>
                    <li>
                <a href="guide/Testing/CoreTesting.html#testing-core" class="">Core testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ExtensionTesting.html#testing-extensions" class="">Extension testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ProjectTesting.html#testing-projects" class="">Project testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingUnit.html#testing-writing-unit" class="">Writing unit tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingFunctional.html#testing-writing-functional" class="">Writing functional tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingAcceptance.html#testing-writing-acceptance" class="">Writing acceptance tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/Faq.html#testing-faq" class="">FAQ</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/About.html#about" class="">About This Manual</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/About.html#intended-audience" class="">Intended Audience</a>
                
            </li>
                    <li>
                <a href="guide/About.html#code-examples-1" class="">Code examples</a>
                
            </li>
                    <li>
                <a href="guide/About.html#feedback-and-contribute" class="">Feedback and Contribute</a>
                
            </li>
                    <li>
                <a href="guide/About.html#credits-1" class="">Credits</a>
                
            </li>
                    <li>
                <a href="guide/About.html#dedication-1" class="">Dedication</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Sitemap.html#sitemap" class="">Sitemap</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/genindex.html#index" class="">Index</a>
</h4>

                        </section>
            
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                                        <section>
        
<div class="section" id="session-management">
    <h1>User session management</h1>
            <p>User sessions in TYPO3 are represented as UserSession objects. The TYPO3
authentication service chain creates or updates user sessions
when authenticating users.</p>
            <p>The UserSession object contains all information regarding a user&#039;s session,
for website visitors with session data (e.g. basket for anonymous / not-logged-in users),
for frontend users as well as authenticated backend users. These are for example,
the session id, the session data, if a session was updated, if the session is anonymous,
or if it is marked as permanent and so on.</p>
            <p>The UserSession object can be used to change and
retrieve information in an object-oriented way.</p>
            <p>For creating UserSession objects the UserSessionManager must be used
since this manager acts as the main factory for user
sessions and therefore handles all necessary tasks like fetching, evaluating
and persisting them. Effectively encapsulating all calls to the
SessionManager which is used for the
session backend.</p>
    </div>
<div class="section" id="public-api-of-php-usersessionmanager">
    <h1>Public API of UserSessionManager</h1>
            <p>The UserSessionManager can be retrieved using its static factory
method create():</p>
            <pre><code class="language-php">use TYPO3\CMS\Core\Session\UserSessionManager

$loginType = &#039;BE&#039;; // or &#039;FE&#039; for frontend
$userSessionManager = UserSessionManager::create($loginType);</code></pre>
            <p>You can then use the UserSessionManager to work
with user sessions. A couple of public methods are available:</p>
            <blockquote><p>The purpose of the UserSessionManager is to create new user session objects (acting as a factory),
depending on the need / request, and to fetch sessions from the session backend, effectively
encapsulating all calls to the SessionManager.</p><p>The UserSessionManager can be retrieved using its static factory method create():</p><pre><code class="language-php">use TYPO3\CMS\Core\Session\UserSessionManager

$loginType = &#039;BE&#039;; // or &#039;FE&#039; for frontend
$userSessionManager = UserSessionManager::create($loginType);</code></pre><blockquote><p>Creates and returns a session from the given request. If the given
$cookieName can not be obtained from the request an anonymous
session will be returned.</p><p>:param Psr\Http\Message\ServerRequestInterface $request: the request
:param string $cookieName: Name of the cookie that might contain the session
:returntype: TYPO3\CMS\Core\Session\UserSession
:returns: An existing session if one is stored in the cookie, an anonymous session otherwise</p></blockquote><blockquote><p><strong>Deprecated:</strong> use createFromRequestOrAnonymous() instead. Will be removed in TYPO3 v13.0.</p><p>Creates and returns a session from a global cookie ($_COOKIE). If
no cookie can be found for the given name, an anonymous session
will be returned. It is recommended to use the
PSR-7-Request based method instead.</p><p>:param string $cookieName: the cookieName
:returntype: TYPO3\CMS\Core\Session\UserSession</p></blockquote><blockquote><p>Creates and returns an anonymous session object (which is not persisted)</p><p>:returntype: TYPO3\CMS\Core\Session\UserSession</p></blockquote><blockquote><p>Checks whether a session has expired. This is also the case if sessionLifetime is 0</p><p>:param TYPO3\CMS\Core\Session\UserSession $session: the session
:returntype: bool</p></blockquote><blockquote><p>Checks whether a given user session will expire within the given grace period</p><p>:param TYPO3\CMS\Core\Session\UserSession $session: the session
:param int $gracePeriod: in seconds
:returntype: bool</p></blockquote><blockquote><p>Persists an anonymous session without a user logged-in,
in order to store session data between requests</p><p>If true, the session will get the ses_permanent flag, defaulta new session object with an updated ses_tstamp (allowing to keep the session alive)</p></blockquote><blockquote><p>Removes existing entries, creates and returns a new user session object.</p><p>See regenerateSession() below.</p><p>If true, the session will get the ses_permanent flag, default: false
:returntype: TYPO3\CMS\Core\Session\UserSession
:returns: The newly created user session object</p></blockquote><blockquote><p>Regenerates the given session. This method should be used whenever a
user proceeds to a higher authorization level, for example when an
anonymous session is now authenticated.</p><p>:param string $sessionId: The session id
:param array $existingSessionRecord: If given, this session record will be used instead of fetching again, default: []
:param bool $anonymous: If true session will be regenerated as anonymous session, default: false
:returntype: TYPO3\CMS\Core\Session\UserSession</p></blockquote><blockquote><p>Updates the session timestamp for the given user session if the session
is marked as &quot;needs update&quot; (which means the current timestamp is
greater than &quot;last updated + a specified grace-time&quot;).</p><p>:param TYPO3\CMS\Core\Session\UserSession $session: the session
:returntype: TYPO3\CMS\Core\Session\UserSession
:returns: a modified user session with a last updated value if needed</p></blockquote><blockquote><p>Checks whether a given session is already persisted</p><p>:param TYPO3\CMS\Core\Session\UserSession $session: the session
:returntype: bool</p></blockquote><blockquote><p>Removes a given session from the session backend</p><p>:param TYPO3\CMS\Core\Session\UserSession $session: the session</p></blockquote><blockquote><p>Updates the session data + timestamp in the session backend</p><p>:param TYPO3\CMS\Core\Session\UserSession $session: the session
:returntype: TYPO3\CMS\Core\Session\UserSession</p></blockquote><blockquote><p>Calls the session backends collectGarbage() method</p><p>:param int $garbageCollectionProbability: the garbageCollectionProbability, default: 1</p></blockquote><blockquote><p>Creates a UserSessionManager instance for the given login type. Has
several optional arguments used for testing purposes to inject dummy
objects if needed.</p><p>Ideally, this factory encapsulates all TYPO3_CONF_VARS options, so
the actual object does not need to consider any global state.</p><p>:param string $loginType: the loginType
:param int $sessionLifetime: the sessionLifetime, default: NULL
:param TYPO3\CMS\Core\Session\SessionManager $sessionManager: the sessionManager, default: NULL
:param TYPO3\CMS\Core\Authentication\IpLocker $ipLocker: the ipLocker, default: NULL
:returntype: self</p></blockquote><blockquote><p>Sets a logger.</p><p>:param Psr\Log\LoggerInterface $logger: the logger</p></blockquote></blockquote>

    </div>
<div class="section" id="public-api-of-php-usersession">
    <h1>Public API of UserSession</h1>
            <p>The session object created or retrieved by the UserSessionManager
provides the following API methods:</p>
            <blockquote><p>Represents all information about a user&#039;s session.</p><p>A user session can be bound to a frontend / backend user, or an anonymous session based on session data stored
in the session backend.</p><p>If a session is anonymous, it can be fixated by storing the session in the backend, but only if there
is data in the session.</p><p>if a session is user-bound, it is automatically fixated.</p><p>The $isNew flag is meant to show that this user session object was not
fetched from the session backend, but initialized in the first place by
the current request.</p><p>The $data argument stores arbitrary data valid for the user&#039;s session.</p><p>A permanent session is not issued by a session-based cookie but a
time-based cookie. The session might be persisted in the user&#039;s browser.</p><blockquote><p>the session ID. This is the ses_id respectively the AbstractUserAuthentication->id</p></blockquote><blockquote><p>the user ID the session belongs to. Can also return 0 or NULL Which indicates an anonymous session. This is the ses_userid.</p></blockquote><blockquote><p>the timestamp of the last session data update. This is the ses_tstamp.</p></blockquote><blockquote><p>Sets or updates session data value for a given $key. It is also
internally used if calling AbstractUserAuthentication->setSessionData()</p><p>The value or NULL to unset the key</p></blockquote><blockquote><p>Checks whether the session has data assigned</p><p>:returntype: bool</p></blockquote><blockquote><p>Returns the session data for the given $key or NULL if the key does
not exist. It is internally used if calling
AbstractUserAuthentication->getSessionData()</p><p>:param string $key: the key</p></blockquote><blockquote><p>:returntype: array
:returns: the whole data array.</p></blockquote><blockquote><p>Overrides the whole data array. Can also be used to unset the array.</p><p>This also sets the $wasUpdated pointer to true</p><p>:param array $data: the data</p></blockquote><blockquote><p>Checks whether the session data has been updated</p><p>:returntype: bool</p></blockquote><blockquote><p>Checks if the user session is an anonymous one. This means, the
session does not belong to a logged-in user</p><p>:returntype: bool</p></blockquote><blockquote><p>the ipLock state of the session</p></blockquote><blockquote><p>Checks whether the session is marked as new</p><p>:returntype: bool</p></blockquote><blockquote><p>Checks whether the session was marked as permanent</p><p>:returntype: bool</p></blockquote><blockquote><p>Checks whether the session has to be updated</p><p>:returntype: bool</p></blockquote><blockquote><p>Gets session ID wrapped in JWT to be used for emitting a new cookie.</p><p>Cookie: ], )></p><p>:returntype: string
:returns: the session ID wrapped in JWT to be used for emitting a new cookie</p></blockquote><blockquote><p>Creates a new user session based on the provided session record</p><p>:param string $id: the session identifier
:param array $record: the record
:param bool $markAsNew: the markAsNew, default: false
:returntype: self</p></blockquote><blockquote><p>Creates a non fixated user session. This means the
session does not belong to a logged-in user</p><p>:param string $identifier: the identifier
:returntype: self</p></blockquote><blockquote><p>Verifies and resolves the session ID from a submitted cookie value:
Cookie: ], )></p><p>:param string $cookieValue: submitted cookie value
:returntype: string
:returns: session ID, null in case verification failed</p></blockquote></blockquote>

    </div>

    </section>
                            </div>
            <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
        </div>
        <a href="guide/ApiOverview/SessionStorageFramework/UserSessionManagement.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>