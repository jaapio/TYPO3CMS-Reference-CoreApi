<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
                    <title>phpDocumentor</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../../../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@100;200;300;400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/template.js"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">phpDocumentor</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -three phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category">
            <h2 class="phpdocumentor-sidebar__category-header">typo3-explained</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Introduction/Index.html#introduction" class="">Introduction</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Introduction/Index.html#system-overview-1" class="">System Overview</a>
                
            </li>
                    <li>
                <a href="guide/Introduction/Index.html#a-basic-installation" class="">A basic installation</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ApiOverview/Index.html#api-a-z" class="">API A-Z</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/CodingGuidelines/Index.html#cgl" class="">Coding Guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/CodingGuidelines/Introduction.html#cgl-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglPhp/Index.html#cgl-php" class="">PHP Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglJavaScript/Index.html#cgl-javascript" class="">JavaScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypeScript/Index.html#cgl-typescript" class="">TypeScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypoScript/Index.html#cgl-typoscript" class="">TypoScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTsConfig.html#cgl-tsconfig" class="">TSconfig Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglXliff/Index.html#cgl-xliff" class="">Xliff Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglYaml.html#cgl-yaml" class="">Yaml Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglRest/Index.html#cgl-rest" class="">reStructuredText (reST)</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Configuration/Index.html#configuration" class="">Configuration</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Configuration/ConfigurationOverview.html#config-overview" class="">Configuration overview</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Glossary.html#configuration-classification" class="">Glossary</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationFiles.html#configuration-files" class="">Configuration files</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationModule/Index.html#configuration-module" class="">Configuration module</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/FeatureToggles.html#feature-toggles" class="">Feature toggles</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/GlobalVariables.html#globals-variables" class="">$GLOBALS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3ConfVars/Index.html#typo3-conf-vars" class="">TYPO3_CONF_VARS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3Information.html#typo3Information" class="">Global meta information about TYPO3</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Tsconfig.html#tsconfig" class="">TSconfig</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/TypoScriptSyntax/Index.html#typoscript-syntax-about" class="">TypoScript syntax</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/UserSettingsConfiguration/Index.html#user-settings" class="">User settings configuration</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Yaml/Index.html#yaml" class="">YAML</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ExtensionArchitecture/Index.html#extension-development" class="">Extension development</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/ExtensionArchitecture/Concepts/Index.html#extension-concepts" class="">Concepts</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/FileStructure/Index.html#extension-reserved-folders-legacy" class="">File structure</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/HowTo/Index.html#extension-howto" class="">Howto</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Extbase/Index.html#extbase" class="">Extbase</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/BestPractises/Index.html#extension-Best-practises" class="">Best practises and conventions</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Tutorials/Index.html#extension-tutorials" class="">Tutorials</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Security/Index.html#security" class="">Security guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Security/Introduction/Index.html#security-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/Security/SecurityTeam/Index.html#security-team" class="">The TYPO3 Security Team</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralInformation/Index.html#security-general-information" class="">General Information</a>
                
            </li>
                    <li>
                <a href="guide/Security/TypesOfThreats/Index.html#security-threats" class="">Types of Security Threats</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralGuidelines/Index.html#security-general-guidelines" class="">General guidelines</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesAdministrators/Index.html#security-administrators" class="">Guidelines for System Administrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesExtensionDevelopment/Index.html#security-extension-development" class="">Guidelines for extension development</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesIntegrators/Index.html#security-integrators" class="">Guidelines for TYPO3 integrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesEditors/Index.html#security-editors" class="">Guidelines for editors</a>
                
            </li>
                    <li>
                <a href="guide/Security/Backups/Index.html#security-backups" class="">Backup strategy</a>
                
            </li>
                    <li>
                <a href="guide/Security/HackedSite/Index.html#security-detect-analyze-repair" class="">Detect, analyze and repair a hacked site</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Testing/Index.html#testing" class="">Testing</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Testing/History.html#testing-history" class="">History</a>
                
            </li>
                    <li>
                <a href="guide/Testing/CoreTesting.html#testing-core" class="">Core testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ExtensionTesting.html#testing-extensions" class="">Extension testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ProjectTesting.html#testing-projects" class="">Project testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingUnit.html#testing-writing-unit" class="">Writing unit tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingFunctional.html#testing-writing-functional" class="">Writing functional tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingAcceptance.html#testing-writing-acceptance" class="">Writing acceptance tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/Faq.html#testing-faq" class="">FAQ</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/About.html#about" class="">About This Manual</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/About.html#intended-audience" class="">Intended Audience</a>
                
            </li>
                    <li>
                <a href="guide/About.html#code-examples-1" class="">Code examples</a>
                
            </li>
                    <li>
                <a href="guide/About.html#feedback-and-contribute" class="">Feedback and Contribute</a>
                
            </li>
                    <li>
                <a href="guide/About.html#credits-1" class="">Credits</a>
                
            </li>
                    <li>
                <a href="guide/About.html#dedication-1" class="">Dedication</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Sitemap.html#sitemap" class="">Sitemap</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/genindex.html#index" class="">Index</a>
</h4>

                        </section>
            
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                                        <section>
        
<div class="section" id="password-hashing">
    <h1>Password hashing</h1>
            <a id="password-hashing-introduction"></a>
    </div>
<div class="section" id="introduction">
    <h1>Introduction</h1>
            <p>TYPO3 never stores passwords in plain text in the database. If the latest configured hash algorithm has been changed,
TYPO3 will update the stored frontend and backend user password hashes upon user login.</p>
            <p>TYPO3 uses modern hash algorithms suitable for the given PHP platform, the
default being Argon2i.</p>
            <p>This section is for administrators and users who want to know more about TYPO3 password hashing and
have a basic understanding of hashing algorithms and configuration in TYPO3.</p>
            <a id="password-hashing-basic-knowledge"></a>
    </div>
<div class="section" id="basic-knowledge">
    <h1>Basic knowledge</h1>
            <p>If a database has been compromised and the passwords have been stored as plain text,
the attacker has most likely gained access to more than just the user&#039;s TYPO3 Frontend / Backend account.
It&#039;s not uncommon for someone to use the same email and password combination for more than one online service,
such as their bank account, social media accounts, or even their email provider.</p>
            <p>To mitigate this risk, we can use one-way <a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function">hash</a> algorithms to transform a plain text password into an incomprehensible
string of seemingly &quot;random&quot; characters.
A hash, (also known as a checksum), is the result of a value (in this case the user&#039;s password) that has been
transformed using a one-way function.
Hashes are called &quot;one-way functions&quot; because they&#039;re quick and easy to generate, but incredibly hard to undo.
You would require an incredible amount of computational power and time to try and reverse a hash back to its original
value.</p>
            <p>When a user tries to log in and submits their password through the login form, the same one-way function is performed
and the result is compared against the hash stored in the database. If they&#039;re the same, we can safely assume the user
typed in the correct password without ever needing to store their actual password!</p>
            <p>The most well-known hash algorithm is MD5. Basic hash algorithms and especially MD5 have drawbacks though:
First, if you find some other string that resolves to the same hash, you&#039;re screwed (that&#039;s called
a collision). An attacker could login with a password that is not identical to &quot;your&quot; password, but still matches
the calculated hash. And second, if an attacker just calculates a huge list of all possible passwords with their
matching hashes (this is called a rainbow table) and puts them into a database to compare any given hash with,
it can easily look up plain text passwords for given hashes. A simple MD5 hash is susceptible to both of these
attack vectors and thus deemed insecure. MD5 rainbow tables for casual passwords can be found online and MD5 collision
creation can be done without too many issues. In short: MD5 is not a suitable hashing algorithm for securing user passwords.</p>
            <p>To mitigate the rainbow table attack vector, the idea of &quot;salting&quot; has been invented: Instead of
hashing the given password directly and always ending up with the same hash for the same password
(if different users use the same password they end up with the same hash in the database), a &quot;salt&quot;
is added to the password. This salt is a random string calculated when the password is first set (when the
user record is created) and stored <em>together</em> with the hash. The basic thinking is that the salt is
added to the password before hashing, the &quot;salt+password&quot; combination is then hashed. The salt is stored
next to the hash in the database. If then a user logs in and submits their username and password, the following
happens:</p>
            
    
<ol>
    <li>the requested user is looked up in the database,</li>
    <li>the salt of this user is looked up in the database,</li>
    <li>the submitted password is concatenated with the salt of the user,</li>
    <li>the &quot;salt+password&quot; combination is then hashed and compared with the stored hash of the user.</li>
</ol>
            <p>This is pretty clever and leads to the situation that users with the same password end up with different
hashes in the database since their randomly calculated salt is different. This effectively makes rainbow
tables (direct hash to password lists) unfeasible.</p>
            <p>During the past years, further attack vectors to salted password hashes have been found. For example,
MD5 hash attacks have been optimized such they are extremely quick on some platforms, where billions of
hashes per second can be calculated with decent time and money efforts. This allows for easy password guessing, even with
salted hashes. Modern password hash algorithms thus try to mitigate these attack vectors. Their hash calculation
is expensive in terms of memory and CPU time even for short input string like passwords
(short as in &quot;not a book of text&quot;) and they can not be easily split into parallel sections to run on many
systems in parallel or optimized into chunks by re-using already computed sections for different input again.</p>
            <p>TYPO3 improved its standards in <a href="https://en.wikipedia.org/wiki/Key_derivation_function">password hash</a> storing over a long time and always went with more modern
approaches: Core version v4.3 from 2009 added salted password storing, v4.5 from 2011 added salted passwords
storing using the algorithm &#039;phpass&#039; by default, v6.2 from 2014 made salted passwords storing mandatory,
v8 added the improved hash algorithm &#039;PBKDF2&#039; and used it by default.</p>
            <p>Currently Argon2i is the default and provided automatically by PHP.
Argon2i is rather resilient against GPU and some other attacks, the default TYPO3 Core  configuration even raises
the default PHP configuration to make attacks on stored Argon2i user password hashes even more unfeasible.</p>
            <p>This is the current state if you are reading this document. The rest is about details: It is possible
to register own password hash algorithms with an extension if you really think this is needed. And it is possible
to change options for frontend and backend user hash algorithms. By default however, TYPO3 automatically selects
a good password hash algorithm and administrators usually do not have to take care of it. The PHP API
is pretty straight forward and helps you to compare passwords with their stored hashes if needed in
extensions.</p>
            <p>One last point on this basic hash knowledge section: Password hashes are always only as secure as
the user submitted password: If a user has a trivial password like &quot;foo&quot;, an attacker who got hold
of the salted password hash will always be successful to crack the hash with a common password hash
crack tool, no matter how expensive the calculation is. Good password hashing does <strong>not</strong> rescue
users from short passwords or simple passwords that can be found in a dictionary. It is usually a
good idea to force users to register with a password that for instance at least has some minimum length.</p>
    </div>
<div class="section" id="what-does-it-look-like">
    <h1>What does it look like?</h1>
            <p>Below is an example of a frontend user with its stored password hash. Since TYPO3 can handle multiple
different hash mechanisms in parallel, each hash is prefixed with a unique string that identifies the
used hash algorithm. In this case it is $argon2i which denotes the Argon2i hash algorithm:</p>
            <pre><code class="language-none">MariaDB [cms]&gt; SELECT uid,username,password FROM fe_users WHERE uid=2;
+-----+----------+---------------------------------------------------------------------------------------------------+
| uid | username | password                                                                                          |
+-----+----------+---------------------------------------------------------------------------------------------------+
|   2 | someuser | $argon2i$v=19$m=16384,t=16,p=2$WFdVRjdqVy9TbVJPajNqcA$vMDP/TBSR0MSA6yalyMpBmFRbCD8UR4bbHZma59yNjQ |
+-----+----------+---------------------------------------------------------------------------------------------------+
1 row in set (0.01 sec)</code></pre>
    </div>
<div class="section" id="configuration">
    <h1>Configuration</h1>
            <p>Configuration of password hashing is done by TYPO3 automatically and
administrators usually do not need to worry about details too much: The
installation process will configure the best available hash algorithm by default.
This is usually Argon2i. Only if the PHP build is incomplete, some less secure
fallback will be selected.</p>
            <p>Switching between hash algorithms in a TYPO3 instance is unproblematic: Password hashes of the old selected
algorithm are just kept but newly created users automatically use the new hash algorithms. If a user
successfully logs in and a hash in the database for that user is found that uses an algorithm no longer
configured as default hash algorithm, the user password hash will be upgraded to the currently selected hash
algorithm. This way, existing user password hashes are updated to better hash algorithms over time, upon login.</p>
            <p>Note that &quot;dead&quot; users (users that don&#039;t use the site anymore and never login) will thus never get their
hashes upgraded to better algorithms. This is an issue that can&#039;t be solved on this hash level directly since
upgrading the password hash always requires the plain text password submitted by the user. However, it is a
good idea to clean up dead users from the database anyway, site administrators should establish processes to
comply with the idea of data minimisation of person related data. TYPO3 helps here for instance with the
&quot;Table garbage collection&quot; task of the scheduler extension, details on this are however out-of-scope of this section.</p>
            <p>To verify and select which specific hash algorithm is currently configured for frontend and backend users, a
preset of the settings module is available. It can be found in
Admin Tools  Settings
 Configuration presets  Password hashing settings:</p>
            <figure>
    <img
    src="./Images/AutomaticScreenshots/AdminTools/PasswordHashingSettings.png"
                        />

            
                    <figcaption><p>Argon2i active for frontend and backend users</p>
</figcaption>
            </figure>

            <p>The image shows settings for an instance that runs with frontend and backend users having their passwords
stored as Argon2i hashes in the database. The other listed algorithms are deemed less secure, they however
rely on different PHP capabilities and might be suitable fall backs if Argon2i is not available for whatever
reason.</p>
    </div>
<div class="section" id="configuration-options">
    <h1>Configuration options</h1>
            <p>Configuration of password hashing is stored in config/system/settings.php with defaults in
DefaultConfiguration.php at five places:</p>
            

<ul>
    <li>$GLOBALS['TYPO3_CONF_VARS']['SYS']['availablePasswordHashAlgorithms']: An array of class names.
This is the list of available password hash algorithms. Extensions may extend this list if they need to
register new (and hopefully even more secure) hash algorithms.</li>
    <li>$GLOBALS['TYPO3_CONF_VARS']['FE']['passwordHashing']['className']: The salt class name configured
as default hash mechanism for frontend users.</li>
    <li>$GLOBALS['TYPO3_CONF_VARS']['FE']['passwordHashing']['options']: Special options of the configured
hash algorithm. This is usually an empty array to fall back to defaults, see below for more details.</li>
    <li>$GLOBALS['TYPO3_CONF_VARS']['BE']['passwordHashing']['className']: The salt class name configured
as default hash mechanism for backend users.</li>
    <li>$GLOBALS['TYPO3_CONF_VARS']['BE']['passwordHashing']['options']: Special options of the configured
hash algorithm. This is usually an empty array to fall back to defaults, see below for more details.</li>
</ul>
    </div>
<div class="section" id="available-hash-algorithms">
    <h1>Available Hash Algorithms</h1>
            <p>The list of available hash mechanisms is pretty rich and may be extended further
if better hash algorithms over time. Most algorithms have additional configuration options that may be
used to increase or lower the needed computation power to calculated hashes. Administrators usually do
not need to fiddle with these and should go with defaults configured by the Core. If changing these options,
administrators should know exactly what they are doing.</p>
            <div class="section" id="argon2i-argon2id">
    <h2>Argon2i / Argon2id</h2>
            <p><a href="https://en.wikipedia.org/wiki/Argon2">Argon2</a> is a modern key derivation function that was selected as the winner of the Password Hashing
Competition in July 2015. There are two available versions:</p>
            

<ul>
    <li>Argon2i: should be available on all PHP builds since PHP version 7.2.</li>
    <li>Argon2id: should be available on all PHP builds since PHP version 7.3.</li>
</ul>
            <p>Options:</p>
            

<ul>
    <li>memory_cost: Maximum memory (in kibibytes) that may be used to compute the Argon2 hash. Defaults to 16384.</li>
    <li>time_cost: Maximum amount of time it may take to compute the Argon2 hash. Defaults to 16.</li>
    <li>threads: Number of threads to use for computing the Argon2 hash. Defaults to 2.</li>
</ul>
    </div>
            <div class="section" id="bcrypt">
    <h2>bcrypt</h2>
            <p><a href="https://en.wikipedia.org/wiki/Bcrypt">bcrypt</a> is a password hashing algorithm based on blowfish and has been presented in 1999. It needs some
additional quirks for long passwords in PHP and should only be used if Argon2i is not available. Options:</p>
            

<ul>
    <li>cost: Denotes the algorithmic cost that should be used. Defaults to 12.</li>
</ul>
    </div>
            <div class="section" id="pbkdf2">
    <h2>PBKDF2</h2>
            <p><a href="https://en.wikipedia.org/wiki/PBKDF2">PBKDF2</a> is a key derivation function recommended by IETF in RFC 8018 as part of the PKCS series, even
though newer password hashing functions such as Argon2i are designed to address weaknesses of PBKDF2.
It could be a preferred password hash algorithm if storing passwords in a FIPS compliant way is necessary. Options:</p>
            

<ul>
    <li>hash_count: Number of hash iterations. Defaults to 25000.</li>
</ul>
    </div>
            <div class="section" id="phpass">
    <h2>phpass</h2>
            <p><a href="https://www.openwall.com/phpass/">phpass</a> phpass is a portable public domain password hashing framework for use in PHP applications since 2005.
The implementation should work on almost all PHP builds. Options:</p>
            

<ul>
    <li>hash_count: The default log2 number of iterations for password stretching. Defaults to 14.</li>
</ul>
    </div>
            <div class="section" id="blowfish">
    <h2>blowfish</h2>
            <p>TYPO3&#039;s salted password hash implementation based on <a href="https://en.wikipedia.org/wiki/Blowfish_(cipher)">blowfish</a> and PHP`s crypt() function. It has
been integrated very early to TYPO3 but should no longer be used. It is only included for instances
that still need to upgrades users to better mechanisms. Options:</p>
            

<ul>
    <li>hash_count: The default log2 number of iterations for password stretching. Defaults to 7.</li>
</ul>
    </div>
            <div class="section" id="md5salt">
    <h2>md5salt</h2>
            <p>TYPO3&#039;s salted password hash implementation based on <a href="https://en.wikipedia.org/wiki/MD5">md5</a> and PHP`s crypt() function. It should not be used
any longer and is only included for instances that still need to upgrade users to better mechanisms.</p>
    </div>
    </div>
<div class="section" id="php-api">
    <h1>PHP API</h1>
            <div class="section" id="creating-a-hash">
    <h2>Creating a Hash</h2>
            <p>To create a new password hash from a given plain-text password, these are the steps to be done:</p>
            

<ul>
    <li>Let the factory deliver an instance of the default hashing class with given context FE or BE</li>
    <li>Create the user password hash</li>
</ul>
            <p>Example implementation for TYPO3 frontend:</p>
            <pre><code class="language-php">// Given plain text password
$password = &#039;someHopefullyGoodAndLongPassword&#039;;
$hashInstance = GeneralUtility::makeInstance(PasswordHashFactory::class)-&gt;getDefaultHashInstance(&#039;FE&#039;);
$hashedPassword = $hashInstance-&gt;getHashedPassword($password);</code></pre>
    </div>
            <div class="section" id="checking-a-password">
    <h2>Checking a Password</h2>
            <p>To check a plain-text password against a password hash, these are the steps to be done:</p>
            

<ul>
    <li>Let the factory deliver an instance of the according hashing class</li>
    <li>Compare plain-text password with salted user password hash</li>
</ul>
            <p>Example implementation for TYPO3 frontend:</p>
            <pre><code class="language-php">// Given plain-text password
$password = &#039;someHopefullyGoodAndLongPassword&#039;;
// The stored password hash from database
$passwordHash = &#039;YYY&#039;;
// The context, either &#039;FE&#039; or &#039;BE&#039;
$mode = &#039;FE&#039;;
$success = GeneralUtility::makeInstance(PasswordHashFactory::class)
    -&gt;get($passwordHash, $mode) # or getDefaultHashInstance($mode)
    -&gt;checkPassword($password, $passwordHash);</code></pre>
    </div>
            <div class="section" id="adding-a-new-hash-mechanism">
    <h2>Adding a new hash mechanism</h2>
            <p>To add an additional hash algorithm, these steps are necessary:</p>
            

<ul>
    <li>Create a new class that implements interface TYPO3\CMS\Core\Crypto\PasswordHashing\PasswordHashInterface</li>
    <li>Register the class as additional entry in $GLOBALS['TYPO3_CONF_VARS']['SYS']['availablePasswordHashAlgorithms']</li>
</ul>
    </div>
    </div>
<div class="section" id="more-information">
    <h1>More Information</h1>
            <div class="toc"><ul class="phpdocumentor-list"><li class="toc-item"><a href="guide/ApiOverview/PasswordHashing/Troubleshooting.html#password-hashing_troubleshooting">Troubleshooting</a></li><li class="toc-item"><a href="guide/ApiOverview/PasswordHashing/Troubleshooting.html#1533818591-invalidpasswordhashexception">#1533818591 InvalidPasswordHashException</a></li></ul></div>
    </div>

    </section>
                            </div>
            <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
        </div>
        <a href="guide/ApiOverview/PasswordHashing/Index.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>