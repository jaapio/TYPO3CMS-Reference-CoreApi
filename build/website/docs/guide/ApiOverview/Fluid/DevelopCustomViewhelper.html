<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
                    <title>phpDocumentor</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../../../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@100;200;300;400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/template.js"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">phpDocumentor</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -three phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category">
            <h2 class="phpdocumentor-sidebar__category-header">typo3-explained</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Introduction/Index.html#introduction" class="">Introduction</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Introduction/Index.html#system-overview-1" class="">System Overview</a>
                
            </li>
                    <li>
                <a href="guide/Introduction/Index.html#a-basic-installation" class="">A basic installation</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ApiOverview/Index.html#api-a-z" class="">API A-Z</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/CodingGuidelines/Index.html#cgl" class="">Coding Guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/CodingGuidelines/Introduction.html#cgl-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglPhp/Index.html#cgl-php" class="">PHP Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglJavaScript/Index.html#cgl-javascript" class="">JavaScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypeScript/Index.html#cgl-typescript" class="">TypeScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypoScript/Index.html#cgl-typoscript" class="">TypoScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTsConfig.html#cgl-tsconfig" class="">TSconfig Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglXliff/Index.html#cgl-xliff" class="">Xliff Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglYaml.html#cgl-yaml" class="">Yaml Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglRest/Index.html#cgl-rest" class="">reStructuredText (reST)</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Configuration/Index.html#configuration" class="">Configuration</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Configuration/ConfigurationOverview.html#config-overview" class="">Configuration overview</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Glossary.html#configuration-classification" class="">Glossary</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationFiles.html#configuration-files" class="">Configuration files</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationModule/Index.html#configuration-module" class="">Configuration module</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/FeatureToggles.html#feature-toggles" class="">Feature toggles</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/GlobalVariables.html#globals-variables" class="">$GLOBALS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3ConfVars/Index.html#typo3-conf-vars" class="">TYPO3_CONF_VARS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3Information.html#typo3Information" class="">Global meta information about TYPO3</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Tsconfig.html#tsconfig" class="">TSconfig</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/TypoScriptSyntax/Index.html#typoscript-syntax-about" class="">TypoScript syntax</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/UserSettingsConfiguration/Index.html#user-settings" class="">User settings configuration</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Yaml/Index.html#yaml" class="">YAML</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ExtensionArchitecture/Index.html#extension-development" class="">Extension development</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/ExtensionArchitecture/Concepts/Index.html#extension-concepts" class="">Concepts</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/FileStructure/Index.html#extension-reserved-folders-legacy" class="">File structure</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/HowTo/Index.html#extension-howto" class="">Howto</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Extbase/Index.html#extbase" class="">Extbase</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/BestPractises/Index.html#extension-Best-practises" class="">Best practises and conventions</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Tutorials/Index.html#extension-tutorials" class="">Tutorials</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Security/Index.html#security" class="">Security guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Security/Introduction/Index.html#security-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/Security/SecurityTeam/Index.html#security-team" class="">The TYPO3 Security Team</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralInformation/Index.html#security-general-information" class="">General Information</a>
                
            </li>
                    <li>
                <a href="guide/Security/TypesOfThreats/Index.html#security-threats" class="">Types of Security Threats</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralGuidelines/Index.html#security-general-guidelines" class="">General guidelines</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesAdministrators/Index.html#security-administrators" class="">Guidelines for System Administrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesExtensionDevelopment/Index.html#security-extension-development" class="">Guidelines for extension development</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesIntegrators/Index.html#security-integrators" class="">Guidelines for TYPO3 integrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesEditors/Index.html#security-editors" class="">Guidelines for editors</a>
                
            </li>
                    <li>
                <a href="guide/Security/Backups/Index.html#security-backups" class="">Backup strategy</a>
                
            </li>
                    <li>
                <a href="guide/Security/HackedSite/Index.html#security-detect-analyze-repair" class="">Detect, analyze and repair a hacked site</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Testing/Index.html#testing" class="">Testing</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Testing/History.html#testing-history" class="">History</a>
                
            </li>
                    <li>
                <a href="guide/Testing/CoreTesting.html#testing-core" class="">Core testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ExtensionTesting.html#testing-extensions" class="">Extension testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ProjectTesting.html#testing-projects" class="">Project testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingUnit.html#testing-writing-unit" class="">Writing unit tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingFunctional.html#testing-writing-functional" class="">Writing functional tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingAcceptance.html#testing-writing-acceptance" class="">Writing acceptance tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/Faq.html#testing-faq" class="">FAQ</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/About.html#about" class="">About This Manual</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/About.html#intended-audience" class="">Intended Audience</a>
                
            </li>
                    <li>
                <a href="guide/About.html#code-examples-1" class="">Code examples</a>
                
            </li>
                    <li>
                <a href="guide/About.html#feedback-and-contribute" class="">Feedback and Contribute</a>
                
            </li>
                    <li>
                <a href="guide/About.html#credits-1" class="">Credits</a>
                
            </li>
                    <li>
                <a href="guide/About.html#dedication-1" class="">Dedication</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Sitemap.html#sitemap" class="">Sitemap</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/genindex.html#index" class="">Index</a>
</h4>

                        </section>
            
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                                        <section>
        
<div class="section" id="fluid-custom-viewhelper">
    <h1>Developing a custom ViewHelper</h1>
            <p>This chapter will demonstrate how to write a custom Fluid ViewHelper in TYPO3.</p>
            <p>A &quot;Gravatar&quot; ViewHelper is created, which uses an email address as parameter
and shows the picture from gravatar.com if it exists.</p>
            <p>The official documentation of Fluid for writing custom ViewHelpers can be found
within the Fluid documentationfluid:creating-viewhelpers.</p>
            <dl>
                        <dt>:local:</dt>
        
        <dd>:depth: 2</dd><dd></dd>    </dl>
    </div>
<div class="section" id="fluid">
    <h1>Fluid</h1>
            <p>The custom ViewHelper is not part of the default distribution. Therefore a
namespace import is necessary to use this ViewHelper. In the following example,
the namespace \MyVendor\BlogExample\ViewHelpers is imported with the
prefix blog. Now, all tags starting with blog: are interpreted as
ViewHelper from within this namespace:</p>
            <pre><code class="language-html">{namespace blog=MyVendor\BlogExample\ViewHelpers}</code></pre>
            <p>For further information about namespace import, see
fluid-syntax-viewhelpers-import-namespaces.</p>
            <p>The ViewHelper should be given the name &quot;gravatar&quot; and only take an email
address as a parameter. The ViewHelper is called in the template as follows:</p>
            <pre><code class="language-html">&lt;blog:gravatar emailAddress=&quot;username@example.org&quot; /&gt;</code></pre>
    </div>
<div class="section" id="abstractviewhelper-implementation">
    <h1>AbstractViewHelper implementation</h1>
            <p>Every ViewHelper is a PHP class. For the Gravatar ViewHelper, the name of the
class is \MyVendor\BlogExample\ViewHelpers\GravatarViewHelper.</p>
            <pre><code class="language-php line-numbers" data-start=1>&lt;?php
namespace MyVendor\BlogExample\ViewHelpers;

use TYPO3Fluid\Fluid\Core\Rendering\RenderingContextInterface;
use TYPO3Fluid\Fluid\Core\ViewHelper\AbstractViewHelper;

final class GravatarViewHelper extends AbstractViewHelper
{
   use CompileWithRenderStatic;

   protected $escapeOutput = false;

   public function initializeArguments()
   {
       // registerArgument($name, $type, $description, $required, $defaultValue, $escape)
       $this-&gt;registerArgument(&#039;emailAddress&#039;, &#039;string&#039;, &#039;The email address to resolve the gravatar for&#039;, true);
   }

   public static function renderStatic(
       array $arguments,
       \Closure $renderChildrenClosure,
       RenderingContextInterface $renderingContext
   ) {
       // this is improved with the TagBasedViewHelper (see below)
       return &#039;&lt;img src=&quot;http://www.gravatar.com/avatar/&#039; .
         md5($arguments[&#039;emailAddress&#039;]) .
         &#039;&quot; /&gt;&#039;;
   }
}</code></pre>
            <div class="section" id="php-abstractviewhelper">
    <h2>AbstractViewHelper</h2>
            <p><em>line 7</em></p>
            <p>Every ViewHelper must inherit from the class
\TYPO3Fluid\Fluid\Core\ViewHelper\AbstractViewHelper.</p>
            <p>A ViewHelper can also inherit from subclasses of AbstractViewHelper, e.g.
from \TYPO3Fluid\Fluid\Core\ViewHelper\AbstractTagBasedViewHelper.
Several subclasses are offering additional functionality. The
TagBasedViewHelper will be explained later on in this chapter in detail.</p>
            <a id="fluid-viewhelper-custom-escaping-of-output"></a>
    </div>
            <div class="section" id="escaping-of-output">
    <h2>Escaping of output</h2>
            <p><em>line 11</em></p>
            <p>Setting the property $escapeOutput to false is necessary to prevent
escaping of output.</p>
            <p>By default, all output is escaped by htmlspecialchars to prevent cross
site scripting.</p>
            <p>If escaping of children is disabled, no nodes passed with inline
syntax or values used as tag content will be escaped. Note that
$escapeOutput takes priority: if it is disabled, escaping child nodes
is also disabled unless explicitly enabled.</p>
            <p>Passing in children is explained in prepare-viewhelper-for-inline-syntax.</p>
            <a id="fluid-viewhelper-custom-initializeArguments"></a>
    </div>
            <div class="section" id="php-initializearguments">
    <h2>initializeArguments()</h2>
            <p><em>line 13</em></p>
            <p>The Gravatar ViewHelper must hand over the email address which
identifies the Gravatar. Every ViewHelper has to declare which parameters are
accepted explicitly. The registration happens inside initializeArguments().</p>
            <p>In the example above, the ViewHelper receives the argument emailAddress of
type string. These arguments can be accessed
through the array $arguments, which is passed into the renderStatic()
method (see next section).</p>
            <div class="phpdocumentor-admonition -tip">
                    <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
            <article>
        <p>Sometimes arguments can take various types. In this case, the type mixed
should be used.</p>

    </article>
</div>
            <a id="fluid-viewhelper-custom-renderStatic"></a>
    </div>
            <div class="section" id="php-renderstatic">
    <h2>renderStatic()</h2>
            <p><em>line 19</em></p>
            <p>The method renderStatic() is called once the ViewHelper is rendered. The
return value of the method is rendered directly.</p>
            

<ul>
    <li>line 9*</li>
</ul>
            <p>The trait CompileWithRenderStatic must be used if the class implements
renderStatic().</p>
            <a id="creating-xml-tags-using-tagbasedviewhelper"></a>
            <a id="creating-html-tags-using-tagbasedviewhelper"></a>
    </div>
    </div>
<div class="section" id="creating-html-xml-tags-with-the-php-abstracttagbasedviewhelper">
    <h1>Creating HTML/XML tags with the AbstractTagBasedViewHelper</h1>
            <p>For ViewHelpers which create HTML/XML tags, Fluid provides an enhanced base
class\TYPO3Fluid\Fluid\Core\ViewHelper\AbstractTagBasedViewHelper.  This
base class provides an instance of
\TYPO3Fluid\Fluid\Core\ViewHelper\TagBuilder that can be used to create
HTML-tags. It takes care of the syntactically correct creation and, for example,
escapes single and double quotes in attribute values.</p>
            <blockquote><p>Correctly escaping the attribute values is mandatory as it affects security
and prevents cross-site scripting attacks.</p></blockquote>
            <p>Because the Gravatar ViewHelper creates an img tag the use of the
\TYPO3Fluid\Fluid\Core\ViewHelper\TagBuilder is advised:</p>
            <pre><code class="language-php line-numbers" data-start=1>&lt;?php
namespace MyVendor\BlogExample\ViewHelpers;

use TYPO3Fluid\Fluid\Core\ViewHelper\AbstractTagBasedViewHelper;

class GravatarViewHelper extends AbstractTagBasedViewHelper
{
    protected $tagName = &#039;img&#039;;

    public function initializeArguments()
    {
        parent::initializeArguments();
        $this-&gt;registerUniversalTagAttributes();
        $this-&gt;registerTagAttribute(&#039;alt&#039;, &#039;string&#039;, &#039;Alternative Text for the image&#039;);
        $this-&gt;registerArgument(&#039;emailAddress&#039;, &#039;string&#039;, &#039;The email address to resolve the gravatar for&#039;, true);
    }

    public function render()
    {
        $this-&gt;tag-&gt;addAttribute(
            &#039;src&#039;,
            &#039;http://www.gravatar.com/avatar/&#039; . md5($this-&gt;arguments[&#039;emailAddress&#039;])
        );
        return $this-&gt;tag-&gt;render();
    }
}</code></pre>
            <p>What is different in this code?</p>
            <p>The attribute $escapeOutput is no longer necessary.</p>
            <div class="section" id="php-abstracttagbasedviewhelper">
    <h2>AbstractTagBasedViewHelper</h2>
            <p><em>line 6</em></p>
            <p>The ViewHelper does not inherit directly from AbstractViewHelper but
from AbstractTagBasedViewHelper, which provides and initializes the tag builder.</p>
    </div>
            <div class="section" id="php-tagname">
    <h2>$tagName</h2>
            <p><em>line 8</em></p>
            <p>There is a class property $tagName which stores the name of the tag to be
created ().</p>
    </div>
            <div class="section" id="php-this-tag-addattribute">
    <h2>$this-tag-addAttribute()</h2>
            <p><em>line 20</em></p>
            <p>The tag builder is available at property $this-tag. It offers the method
addAttribute() to add new tag attributes. In our example the attribute
src is added to the tag.</p>
    </div>
            <div class="section" id="php-this-tag-render">
    <h2>$this-tag-render()</h2>
            <p><em>line 24</em></p>
            <p>The GravatarViewHelper creates an img tag builder, which has a method named
render(). After configuring the tag builder instance, the rendered tag
markup is returned.</p>
            <div class="phpdocumentor-admonition -note">
            <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <article>
        <p>As $this-tag is an object property, render() is used to
generate the output. renderStatic() would have no access. For further
information take a look at the-different-render-methods.</p>

    </article>
</div>
    </div>
            <div class="section" id="php-this-registertagattribute">
    <h2>$this-registerTagAttribute()</h2>
            <p>Furthermore the TagBasedViewHelper offers assistance for ViewHelper
arguments that should recur directly and unchanged as tag attributes. These
must be registered with the method $this-registerTagAttribute()
within initializeArguments.
If support for the  attribute alt
should be provided in the ViewHelper, this can be done by initializing this in
initializeArguments() in the following way:</p>
            <pre><code class="language-php">public function initializeArguments()
{
    // registerTagAttribute($name, $type, $description, $required = false)
    $this-&gt;registerTagAttribute(&#039;alt&#039;, &#039;string&#039;, &#039;Alternative Text for the image&#039;);
}</code></pre>
            <p>For registering the universal attributes id, class, dir, style, lang, title,
accesskey and tabindex there is a helper method
registerUniversalTagAttributes() available.</p>
            <p>If support for universal attributes should be provided and in addition to the
alt attribute in the Gravatar ViewHelper the following
initializeArguments() method will be necessary:</p>
            <pre><code class="language-php">public function initializeArguments()
{
    parent::initializeArguments();
    $this-&gt;registerUniversalTagAttributes();
    $this-&gt;registerTagAttribute(&#039;alt&#039;, &#039;string&#039;, &#039;Alternative Text for the image&#039;);
}</code></pre>
            <a id="insert-optional-arguments"></a>
    </div>
    </div>
<div class="section" id="insert-optional-arguments-1">
    <h1>Insert optional arguments</h1>
            <p>An optional size for the image can be provided to the Gravatar ViewHelper. This
size parameter will determine the height and width in pixels of the
image and can range from 1 to 512. When no size is given, an image of 80px is
generated.</p>
            <p>The render() method can be improved like this:</p>
            <pre><code class="language-php">public function initializeArguments()
{
    $this-&gt;registerArgument(&#039;emailAddress&#039;, &#039;string&#039;, &#039;The email address to resolve the gravatar for&#039;, true);
    $this-&gt;registerArgument(&#039;size&#039;, &#039;integer&#039;, &#039;The size of the gravatar, ranging from 1 to 512&#039;, false, 80);
}

public function render()
{
    $this-&gt;tag-&gt;addAttribute(
       &#039;src&#039;,
       &#039;http://www.gravatar.com/avatar/&#039; .
           md5($this-&gt;arguments[&#039;emailAddress&#039;]) .
           &#039;?s=&#039; . urlencode($this-&gt;arguments[&#039;size&#039;])
    );
    return $this-&gt;tag-&gt;render();
}</code></pre>
            <p>With this setting of a default value and setting the fourth argument to false,
the size attribute becomes optional.</p>
            <a id="prepare-viewhelper-for-inline-syntax"></a>
    </div>
<div class="section" id="prepare-viewhelper-for-inline-syntax-1">
    <h1>Prepare ViewHelper for inline syntax</h1>
            <p>So far, the Gravatar ViewHelper has focused on the tag structure of the
ViewHelper. The call to render the ViewHelper was written with tag syntax, which
seemed obvious because it itself returns a tag:</p>
            <pre><code class="language-html">&lt;blog:gravatar emailAddress=&quot;{post.author.emailAddress}&quot; /&gt;</code></pre>
            <p>Alternatively, this expression can be written using the inline notation:</p>
            <pre><code class="language-html">{blog:gravatar(emailAddress: post.author.emailAddress)}</code></pre>
            <p>One should see the Gravatar ViewHelper as a kind of post-processor for an email
address and would allow the following syntax:</p>
            <pre><code class="language-html">{post.author.emailAddress -&gt; blog:gravatar()}</code></pre>
            <p>This syntax places focus on the variable that is passed to the ViewHelper as it
comes first.</p>
            <p>The syntax {post.author.emailAddress -> blog:gravatar()} is an alternative
syntax for {post.author.emailAddress}. To
support this, the email address comes either from the argument emailAddress
or, if it is empty, the content of the tag should be interpreted as email
address.</p>
            <p>This is typically used with formatting ViewHelpers. These ViewHelpers all
support both tag mode and inline syntax.</p>
            <p>Depending on the implemented method for rendering, the implementation is
different:</p>
            <a id="with-renderstatic"></a>
            <div class="section" id="with-php-renderstatic">
    <h2>With renderStatic()</h2>
            <p>To fetch the content of the ViewHelper, the argument
$renderChildrenClosure is available.  This returns the evaluated object
between the opening and closing tag.</p>
            <p>Lets have a look at the new code of the renderStatic() method:</p>
            <pre><code class="language-php">&lt;?php
namespace MyVendor\BlogExample\ViewHelpers;

use TYPO3Fluid\Fluid\Core\Rendering\RenderingContextInterface;
use TYPO3Fluid\Fluid\Core\ViewHelper\Traits\CompileWithRenderStatic;
use TYPO3Fluid\Fluid\Core\ViewHelper\AbstractViewHelper;

class GravatarViewHelper extends AbstractViewHelper
{
    use CompileWithContentArgumentAndRenderStatic;

    protected $escapeOutput = false;

    public function initializeArguments()
    {
        $this-&gt;registerArgument(&#039;emailAddress&#039;, &#039;string&#039;, &#039;The email address to resolve the gravatar for&#039;);
    }

    public static function renderStatic(
        array $arguments,
        \Closure $renderChildrenClosure,
        RenderingContextInterface $renderingContext
    ) {
        $emailAddress = $renderChildrenClosure();

        return &#039;&lt;img src=&quot;http://www.gravatar.com/avatar/&#039; .
            md5($emailAddress) .
            &#039;&quot; /&gt;&#039;;
    }
}</code></pre>
            <a id="with-render"></a>
    </div>
            <div class="section" id="with-php-render">
    <h2>With render()</h2>
            <p>To fetch the content of the ViewHelper the method renderChildren() is
available in the AbstractViewHelper. This returns the evaluated object
between the opening and closing tag.</p>
            <p>Lets have a look at the new code of the render() method:</p>
            <pre><code class="language-php">&lt;?php
namespace MyVendor\BlogExample\ViewHelpers;

use TYPO3Fluid\Fluid\Core\ViewHelper\AbstractTagBasedViewHelper;

class GravatarViewHelper extends AbstractTagBasedViewHelper
{
    protected $tagName = &#039;img&#039;;

    public function initializeArguments()
    {
        $this-&gt;registerArgument(&#039;emailAddress&#039;, &#039;string&#039;, &#039;The email address to resolve the gravatar for&#039;, false, null);
    }

    public function render()
    {
        $emailAddress = $this-&gt;arguments[&#039;emailAddress&#039;] ?? $this-&gt;renderChildren();

        $this-&gt;tag-&gt;addAttribute(
            &#039;src&#039;,
            &#039;http://www.gravatar.com/avatar/&#039; . md5($emailAddress)
        );

        return $this-&gt;tag-&gt;render();
    }
}</code></pre>
            <a id="handle-additional-arguments"></a>
    </div>
    </div>
<div class="section" id="handle-additional-arguments-1">
    <h1>Handle additional arguments</h1>
            <p>If a ViewHelper allows further arguments which have not been explicitly
configured, the handleAdditionalArguments() method can be implemented.</p>
            <p>The \TYPO3Fluid\Fluid\Core\ViewHelper\AbstractTagBasedViewHelper makes use
of this, to allow setting any data- argument for tag based ViewHelpers.</p>
            <p>The method will receive an array of all arguments, which are passed in addition
to the registered arguments. The array uses the argument name as the key and the
argument value as the value. Within the method, these arguments can be handled.</p>
            <p>For example, the AbstractTagBasedViewHelper implements the following:</p>
            <pre><code class="language-php">public function handleAdditionalArguments(array $arguments)
{
    $unassigned = [];
    foreach ($arguments as $argumentName =&gt; $argumentValue) {
        if (strpos($argumentName, &#039;data-&#039;) === 0) {
            $this-&gt;tag-&gt;addAttribute($argumentName, $argumentValue);
        } else {
            $unassigned[$argumentName] = $argumentValue;
        }
    }
    parent::handleAdditionalArguments($unassigned);
}</code></pre>
            <p>To keep the default behavior, all unwanted arguments should be passed to the
parent method call parent::handleAdditionalArguments($unassigned);, to
throw exceptions accordingly.</p>
            <a id="the-different-render-methods"></a>
    </div>
<div class="section" id="the-different-render-methods-1">
    <h1>The different render methods</h1>
            <p>ViewHelpers can have one or more of the following three methods for
implementing the rendering. The following section will describe the differences
between all three implementations.</p>
            <a id="compile-method"></a>
            <div class="section" id="php-compile-method">
    <h2>compile()-Method</h2>
            <p>This method can be overwritten to define how the ViewHelper should be compiled.
That can make sense if the ViewHelper itself is a wrapper for another native PHP
function or TYPO3 function. In that case, the method can return the call to this
function and remove the need to call the ViewHelper as a wrapper at all.</p>
            <p>The compile() has to return the compiled PHP code for the ViewHelper.
Also the argument $initializationPhpCode can be used to add further PHP
code before the execution.</p>
            <div class="phpdocumentor-admonition -note">
            <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <article>
        <p>The renderStatic() method still has to be implemented for the non
compiled version of the ViewHelper. In the future, this should no longer be
necessary.</p>

    </article>
</div>
            <p>Example implementation:</p>
            <pre><code class="language-php">&lt;?php
namespace MyVendor\BlogExample\ViewHelpers;

use TYPO3Fluid\Fluid\Core\Compiler\TemplateCompiler;
use TYPO3Fluid\Fluid\Core\Parser\SyntaxTree\ViewHelperNode;
use TYPO3Fluid\Fluid\Core\Rendering\RenderingContextInterface;
use TYPO3Fluid\Fluid\Core\ViewHelper\Traits\CompileWithRenderStatic;
use TYPO3Fluid\Fluid\Core\ViewHelper\AbstractViewHelper;

class StrtolowerViewHelper extends AbstractViewHelper
{
    use CompileWithRenderStatic;

    public function initializeArguments()
    {
        $this-&gt;registerArgument(&#039;string&#039;, &#039;string&#039;, &#039;The string to lowercase.&#039;, true);
    }

    public static function renderStatic(
        array $arguments,
        \Closure $renderChildrenClosure,
        RenderingContextInterface $renderingContext
    ) {
        return strtolower($arguments[&#039;string&#039;]);
    }

    public function compile(
        $argumentsName,
        $closureName,
        &amp;$initializationPhpCode,
        ViewHelperNode $node,
        TemplateCompiler $compiler
    ) {
        return &#039;strtolower(&#039; . $argumentsName. &#039;[\&#039;string\&#039;])&#039;;
    }
}</code></pre>
            <a id="renderstatic-method"></a>
    </div>
            <div class="section" id="php-renderstatic-method">
    <h2>renderStatic()-Method</h2>
            <p>Most of the time, this method is implemented. It&#039;s the one that is called by
default from within the compiled Fluid.</p>
            <p>It is, however, not called on AbstractTagBasedViewHelper implementations. With these classes
you still need to use the render() method since that is the only way you can access $this-tag
which contains the tag builder that generates the actual XML tag.</p>
            <p>As this method has to be static, there is no access to object properties such as
$this-tag (in a subclass of AbstractTagBasedViewHelper) from within
renderStatic.</p>
            <div class="phpdocumentor-admonition -note">
            <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <article>
        <p>This method can not be used when access to child nodes is necessary. This is
the case for ViewHelpers like if or switch which need to access their
children like then or else. In that case, render() has to be used.</p>

    </article>
</div>
            <a id="render-method"></a>
    </div>
            <div class="section" id="php-render-method">
    <h2>render()-Method</h2>
            <p>This method is the slowest one. Only use this method if it is necessary, for
example if access to properties is necessary.</p>
    </div>
    </div>

    </section>
                            </div>
            <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
        </div>
        <a href="guide/ApiOverview/Fluid/DevelopCustomViewhelper.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>