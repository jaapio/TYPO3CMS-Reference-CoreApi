<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
                    <title>phpDocumentor</title>
    

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../../../../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@100;200;300;400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/template.js"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">phpDocumentor</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -three phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category">
            <h2 class="phpdocumentor-sidebar__category-header">typo3-explained</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Introduction/Index.html#introduction" class="">Introduction</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Introduction/Index.html#system-overview-1" class="">System Overview</a>
                
            </li>
                    <li>
                <a href="guide/Introduction/Index.html#a-basic-installation" class="">A basic installation</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ApiOverview/Index.html#api-a-z" class="">API A-Z</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/CodingGuidelines/Index.html#cgl" class="">Coding Guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/CodingGuidelines/Introduction.html#cgl-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglPhp/Index.html#cgl-php" class="">PHP Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglJavaScript/Index.html#cgl-javascript" class="">JavaScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypeScript/Index.html#cgl-typescript" class="">TypeScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTypoScript/Index.html#cgl-typoscript" class="">TypoScript Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglTsConfig.html#cgl-tsconfig" class="">TSconfig Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglXliff/Index.html#cgl-xliff" class="">Xliff Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglYaml.html#cgl-yaml" class="">Yaml Coding Guidelines</a>
                
            </li>
                    <li>
                <a href="guide/CodingGuidelines/CglRest/Index.html#cgl-rest" class="">reStructuredText (reST)</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Configuration/Index.html#configuration" class="">Configuration</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Configuration/ConfigurationOverview.html#config-overview" class="">Configuration overview</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Glossary.html#configuration-classification" class="">Glossary</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationFiles.html#configuration-files" class="">Configuration files</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/ConfigurationModule/Index.html#configuration-module" class="">Configuration module</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/FeatureToggles.html#feature-toggles" class="">Feature toggles</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/GlobalVariables.html#globals-variables" class="">$GLOBALS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3ConfVars/Index.html#typo3-conf-vars" class="">TYPO3_CONF_VARS</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Typo3Information.html#typo3Information" class="">Global meta information about TYPO3</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Tsconfig.html#tsconfig" class="">TSconfig</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/TypoScriptSyntax/Index.html#typoscript-syntax-about" class="">TypoScript syntax</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/UserSettingsConfiguration/Index.html#user-settings" class="">User settings configuration</a>
                
            </li>
                    <li>
                <a href="guide/Configuration/Yaml/Index.html#yaml" class="">YAML</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/ExtensionArchitecture/Index.html#extension-development" class="">Extension development</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/ExtensionArchitecture/Concepts/Index.html#extension-concepts" class="">Concepts</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/FileStructure/Index.html#extension-reserved-folders-legacy" class="">File structure</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/HowTo/Index.html#extension-howto" class="">Howto</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Extbase/Index.html#extbase" class="">Extbase</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/BestPractises/Index.html#extension-Best-practises" class="">Best practises and conventions</a>
                
            </li>
                    <li>
                <a href="guide/ExtensionArchitecture/Tutorials/Index.html#extension-tutorials" class="">Tutorials</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Security/Index.html#security" class="">Security guidelines</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Security/Introduction/Index.html#security-introduction" class="">Introduction</a>
                
            </li>
                    <li>
                <a href="guide/Security/SecurityTeam/Index.html#security-team" class="">The TYPO3 Security Team</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralInformation/Index.html#security-general-information" class="">General Information</a>
                
            </li>
                    <li>
                <a href="guide/Security/TypesOfThreats/Index.html#security-threats" class="">Types of Security Threats</a>
                
            </li>
                    <li>
                <a href="guide/Security/GeneralGuidelines/Index.html#security-general-guidelines" class="">General guidelines</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesAdministrators/Index.html#security-administrators" class="">Guidelines for System Administrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesExtensionDevelopment/Index.html#security-extension-development" class="">Guidelines for extension development</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesIntegrators/Index.html#security-integrators" class="">Guidelines for TYPO3 integrators</a>
                
            </li>
                    <li>
                <a href="guide/Security/GuidelinesEditors/Index.html#security-editors" class="">Guidelines for editors</a>
                
            </li>
                    <li>
                <a href="guide/Security/Backups/Index.html#security-backups" class="">Backup strategy</a>
                
            </li>
                    <li>
                <a href="guide/Security/HackedSite/Index.html#security-detect-analyze-repair" class="">Detect, analyze and repair a hacked site</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Testing/Index.html#testing" class="">Testing</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/Testing/History.html#testing-history" class="">History</a>
                
            </li>
                    <li>
                <a href="guide/Testing/CoreTesting.html#testing-core" class="">Core testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ExtensionTesting.html#testing-extensions" class="">Extension testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/ProjectTesting.html#testing-projects" class="">Project testing</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingUnit.html#testing-writing-unit" class="">Writing unit tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingFunctional.html#testing-writing-functional" class="">Writing functional tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/WritingAcceptance.html#testing-writing-acceptance" class="">Writing acceptance tests</a>
                
            </li>
                    <li>
                <a href="guide/Testing/Faq.html#testing-faq" class="">FAQ</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/About.html#about" class="">About This Manual</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="guide/About.html#intended-audience" class="">Intended Audience</a>
                
            </li>
                    <li>
                <a href="guide/About.html#code-examples-1" class="">Code examples</a>
                
            </li>
                    <li>
                <a href="guide/About.html#feedback-and-contribute" class="">Feedback and Contribute</a>
                
            </li>
                    <li>
                <a href="guide/About.html#credits-1" class="">Credits</a>
                
            </li>
                    <li>
                <a href="guide/About.html#dedication-1" class="">Dedication</a>
                
            </li>
            </ul>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/Sitemap.html#sitemap" class="">Sitemap</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="guide/genindex.html#index" class="">Index</a>
</h4>

                        </section>
            
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                                        <section>
        
<div class="section" id="database-connection">
    <h1>Connection</h1>
            <p>:local:</p>
            <a id="database-connection-introduction"></a>
    </div>
<div class="section" id="introduction">
    <h1>Introduction</h1>
            <p>The TYPO3\CMS\Core\Database\Connection class extends the basic Doctrine
DBAL Doctrine\DBAL\Connection class and is mainly used internally in
TYPO3 to establish, maintain and terminate connections to single database
endpoints. These internal methods are not the scope of this documentation, since
an extension developer usually does not have to deal with them.</p>
            <p>However, for an extension developer, the class provides a list of short-hand
methods that allow you to deal with query cases without the complexity
of the query builder. Using these methods
usually ends up in rather short and easy-to-read code. The methods have in common
that they only support &quot;equal&quot; comparisons in WHERE conditions, that all
fields and values are automatically fully quoted, and that the created queries
are executed right away.</p>
            <div class="phpdocumentor-admonition -note">
            <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <article>
        <p>The Connection object is designed to work on a single table only. If
queries are performed on multiple tables, the object must not be reused.
Instead, a single Connection instance per target table should be
retrieved via ConnectionPool. However, it
is allowed to use one Connection object for multiple queries on the
same table.</p>

    </article>
</div>
            <a id="database-connection-instantiation"></a>
    </div>
<div class="section" id="instantiation">
    <h1>Instantiation</h1>
            <div class="section" id="using-the-connection-pool">
    <h2>Using the connection pool</h2>
            <p>An instance of the TYPO3\CMS\Core\Database\Connection class is retrieved
from the ConnectionPool by calling
-getConnectionForTable() and passing the table name for which a query
should be executed. The ConnectionPool can be injected via constructor:</p>
            <p>:caption: <a href="EXT:my_extension/Classes/Domain/Repository/MyTableRepository.php">EXT:my_extension/Classes/Domain/Repository/MyTableRepository.php</a></p>
    </div>
            <div class="section" id="via-dependency-injection">
    <h2>Via dependency injection</h2>
            <p>Another way is to inject the Connection object directly via
dependency injection if you only use one table.</p>
            
    
<ol>
    <li><p>Configure the concrete connection as a service</p><p>To make a concrete Connection object available as a service, use
the factory option in the service configuration:</p><pre><code class="language-yaml">services:
  _defaults:
    autowire: true
    autoconfigure: true
    public: false

  MyVendor\MyExtension\:
    resource: &#039;../Classes/*&#039;

  connection.tx_myextension_domain_model_mytable:
    class: &#039;TYPO3\CMS\Core\Database\Connection&#039;
    factory: [&#039;@TYPO3\CMS\Core\Database\ConnectionPool&#039;, &#039;getConnectionForTable&#039;]
    arguments:
      - &#039;tx_myextension_domain_model_mytable&#039;

  MyVendor\MyExtension\Domain\Repository\MyTableRepository:
    arguments:
      - &#039;@connection.tx_myextension_domain_model_mytable&#039;</code></pre></li>
    <li><p>Use constructor injection in your class</p><p>Now the Connection object for a specific table can be injected via
the constructor:</p><p>:caption: <a href="EXT:my_extension/Classes/Domain/Repository/MyTableRepository.php">EXT:my_extension/Classes/Domain/Repository/MyTableRepository.php</a></p></li>
</ol>
            <a id="database-connection-insert"></a>
    </div>
    </div>
<div class="section" id="insert">
    <h1>insert()</h1>
            <p>The insert() method creates and executes an INSERT INTO statement.
A (slightly simplified) example from the Registry API:</p>
            <pre><code class="language-php">// INSERT
//     INTO `sys_registry` (`entry_namespace`, `entry_key`, `entry_value`)
//     VALUES (&#039;aoeu&#039;, &#039;aoeu&#039;, &#039;s:3:\&quot;bar\&quot;;&#039;)
$this-&gt;connectionPool
    -&gt;getConnectionForTable(&#039;sys_registry&#039;)
    -&gt;insert(
        &#039;sys_registry&#039;,
        [
            &#039;entry_namespace&#039; =&gt; $namespace,
            &#039;entry_key&#039; =&gt; $key,
            &#039;entry_value&#039; =&gt; serialize($value)
        ]
    );</code></pre>
            <p>Read how to instantiate a connection
with the connection pool.</p>
            <p>Arguments of the insert() method:</p>
            
    
<ol>
    <li>The name of the table the row should be inserted. Required.</li>
    <li>An associative array containing field/value pairs. The key is a field name,
the value is the value to be inserted. All keys are quoted to field names
and all values are quoted to string values. Required.</li>
    <li><p>Specify how single values are quoted. This is useful if a date, number or
similar should be inserted. Optional.</p><p>The example below quotes the first value to an integer and the second one to
a string:</p><pre><code class="language-php">// use TYPO3\CMS\Core\Database\Connection;
// INSERT INTO `sys_log` (`userid`, `details`) VALUES (42, &#039;lorem&#039;)
$this-&gt;connectionPool
    -&gt;getConnectionForTable(&#039;sys_log&#039;)
    -&gt;insert(
        &#039;sys_log&#039;,
        [
            &#039;userid&#039; =&gt; (int)$userId,
            &#039;details&#039; =&gt; (string)$details,
        ],
        [
            Connection::PARAM_INT,
            Connection::PARAM_STR,
        ]
    );</code></pre><p>Read how to instantiate a
connection with the connection pool.</p></li>
</ol>
            <p>insert() returns the number of affected rows. Guess what? That is the
number 1 ... If something goes wrong, a \Doctrine\DBAL\Exception is
thrown.</p>
            <div class="phpdocumentor-admonition -note">
            <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <article>
        <p>A list of allowed field types for proper quoting can be found in the
TYPO3\CMS\Core\Database\Connection class.</p>

    </article>
</div>
            <a id="database-connection-bulk-insert"></a>
    </div>
<div class="section" id="bulkinsert">
    <h1>bulkInsert()</h1>
            <p>This method insert multiple rows at once:</p>
            <pre><code class="language-php">// use TYPO3\CMS\Core\Database\Connection;
$connection = $this-&gt;connectionPool-&gt;getConnectionForTable(&#039;sys_log&#039;);
$connection-&gt;bulkInsert(
    &#039;sys_log&#039;,
    [
        [(int)$userId, (string)$details1],
        [(int)$userId, (string)$details2],
    ],
    [
        &#039;userid&#039;,
        &#039;details&#039;,
    ],
    [
        Connection::PARAM_INT,
        Connection::PARAM_STR,
    ]
);</code></pre>
            <p>Read how to instantiate a connection
with the connection pool.</p>
            <p>Arguments of the bulkInsert() method:</p>
            
    
<ol>
    <li>The name of the table the row should be inserted. Required.</li>
    <li>An array of the values to be inserted. Required.</li>
    <li>An array containing the column names of the data which should be inserted.
Optional.</li>
    <li>Specify how single values are quoted. Similar to insert(); if omitted, everything will be quoted
to strings. Optional.</li>
</ol>
            <p>The number of inserted rows are returned. If something goes wrong, a
\Doctrine\DBAL\Exception is thrown.</p>
            <div class="phpdocumentor-admonition -note">
            <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <article>
        <p>MySQL is quite forgiving when it comes to insufficient field quotingint field does not cause an error and
MySQL adjusts internally. However, other DBMSes (Database management
systems) are not that relaxed and may raise errors. It is good practice to
specify field types for each field, especially if they are not strings.
Doing this immediately will reduce the number of bugs that occur when people
run your extension an anything else than MySQL.</p>

    </article>
</div>
            <a id="database-connection-update"></a>
    </div>
<div class="section" id="update">
    <h1>update()</h1>
            <p>Create an UPDATE statement and execute it. The example from FAL&#039;s
ResourceStorage sets a storage to offline:</p>
            <pre><code class="language-php">// use TYPO3\CMS\Core\Database\Connection;
// UPDATE `sys_file_storage` SET `is_online` = 0 WHERE `uid` = &#039;42&#039;
$this-&gt;connectionPool
    -&gt;getConnectionForTable(&#039;sys_file_storage&#039;)
    -&gt;update(
        &#039;sys_file_storage&#039;,
        [&#039;is_online&#039; =&gt; 0],
        [&#039;uid&#039; =&gt; (int)$this-&gt;getUid()],
        [Connection::PARAM_INT]
    );</code></pre>
            <p>Read how to instantiate a connection
with the connection pool.</p>
            <p>Arguments of the update() method:</p>
            
    
<ol>
    <li>The name of the table to update. Required.</li>
    <li>An associative array containing field/value pairs to be updated. The key is
a field name, the value is the value. In SQL they are mapped to the
SET keyword. Required.</li>
    <li>The update criteria as an array of key/value pairs. The key is the field
name, the value is the value. In SQL they are mapped in a WHERE
keyword combined with AND. Required.</li>
    <li>Specify how single values are quoted. Similar to insert(); if omitted, everything will be quoted
to strings. Optional.</li>
</ol>
            <p>The method returns the number of updated rows. If something goes wrong, a
\Doctrine\DBAL\Exception is thrown.</p>
            <div class="phpdocumentor-admonition -note">
            <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <article>
        <p>The third argument <code>WHERE `foo` = &#039;bar&#039;</code> supports only equal =. For more
complex stuff the query builder must be used.</p>

    </article>
</div>
            <a id="database-connection-delete"></a>
    </div>
<div class="section" id="delete">
    <h1>delete()</h1>
            <p>Execute a DELETE query using equal conditions in WHERE, example
from BackendUtility, to mark rows as no longer locked by a user:</p>
            <pre><code class="language-php">// use TYPO3\CMS\Core\Database\Connection;
// DELETE FROM `sys_lockedrecords` WHERE `userid` = 42
$this-&gt;connectionPool
    -&gt;getConnectionForTable(&#039;sys_lockedrecords&#039;)
    -&gt;delete(
        &#039;sys_lockedrecords&#039;,
        [&#039;userid&#039; =&gt; (int)42],
        [Connection::PARAM_INT]
    );</code></pre>
            <p>Read how to instantiate a connection
with the connection pool.</p>
            <p>Arguments of the delete() method:</p>
            
    
<ol>
    <li>The name of the table. Required.</li>
    <li>The delete criteria as an array of key/value pairs. The key is the field
name, the value is the value. In SQL they are mapped in a WHERE
keyword combined with AND. Required.</li>
    <li>Specify how single values are quoted. Similar to insert(); if omitted, everything will be quoted
to strings. Optional.</li>
</ol>
            <p>The method returns the number of deleted rows. If something goes wrong, a
\Doctrine\DBAL\Exception is thrown.</p>
            <div class="phpdocumentor-admonition -note">
            <svg class="phpdocumentor-admonition__icon" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"></path></svg>
                    <article>
        <p>TYPO3 uses a &quot;soft delete&quot; approach for
many tables. Instead of deleting a  row directly in the database, a field -
often called deleted - is set from 0 to 1. Executing a DELETE
query circumvents this and really removes rows from a table. For most
tables, it is better to use the DataHandler API
to handle deletions instead of executing such low-level queries directly.</p>

    </article>
</div>
            <a id="database-connection-truncate"></a>
    </div>
<div class="section" id="truncate">
    <h1>truncate()</h1>
            <p>This method empties a table, removing all rows. It is usually much faster than
a delete() of all rows. This typically
resets &quot;auto increment primary keys&quot; to zero. Use with care:</p>
            <pre><code class="language-php">// TRUNCATE `cache_treelist`
$this-&gt;connectionPool
    -&gt;getConnectionForTable(&#039;cache_treelist&#039;)
    -&gt;truncate(&#039;cache_treelist&#039;);</code></pre>
            <p>Read how to instantiate a connection
with the connection pool.</p>
            <p>The argument is the name of the table to be truncated. If something goes wrong,
a \Doctrine\DBAL\Exception is thrown.</p>
            <a id="database-connection-count"></a>
    </div>
<div class="section" id="count">
    <h1>count()</h1>
            <p>This method executes a COUNT query. Again, this becomes useful when very
simple COUNT statements are to be executed. The example below returns the
number of active rows from the table tt_content whose bodytext
field set to lorem:</p>
            <pre><code class="language-php">// SELECT COUNT(*)
// FROM `tt_content`
// WHERE
//     (`bodytext` = &#039;lorem&#039;)
//     AND (
//         (`tt_content`.`deleted` = 0)
//         AND (`tt_content`.`hidden` = 0)
//         AND (`tt_content`.`starttime` &lt;= 1475621940)
//         AND ((`tt_content`.`endtime` = 0) OR (`tt_content`.`endtime` &gt; 1475621940))
//     )
$connection = $this-&gt;connectionPool-&gt;getConnectionForTable(&#039;tt_content&#039;);
$rowCount = $connection-&gt;count(
    &#039;*&#039;,
    &#039;tt_content&#039;,
    [&#039;bodytext&#039; =&gt; &#039;lorem&#039;]
);</code></pre>
            <p>Read how to instantiate a connection
with the connection pool.</p>
            <p>Arguments of the count() method:</p>
            
    
<ol>
    <li>The field to count, usually * or uid. Required.</li>
    <li>The name of the table. Required.</li>
    <li>The select criteria as an array of key/value pairs. The key is the field
name, the value is the value. In SQL they are mapped in a WHERE
keyword combined with AND. Required.</li>
</ol>
            <p>The method returns the counted rows.</p>
            <p>Remarks:</p>
            

<ul>
    <li>Connection::count() returns the number directly as an integer, unlike
the method of the query builder it is not
necessary to call -fetchColumns(0) or similar.</li>
    <li>The third argument expects all WHERE values to be strings, each
single expression is combined with AND.</li>
    <li>The restriction builder kicks in and
adds additional WHERE conditions based on TCA settings.</li>
    <li>Field names and values are quoted automatically.</li>
    <li>If anything more complex than a simple equal condition on WHERE is
needed, the query builder methods are the
better choiceselect(),
the -count() query is often the least useful method of the
Connection object.</li>
</ul>
            <a id="database-connection-select"></a>
    </div>
<div class="section" id="select">
    <h1>select()</h1>
            <p>This method creates and executes a simple SELECT query based on equal
conditions. Its usage is limited, the restriction builder kicks in and key/value pairs are automatically
quoted:</p>
            <pre><code class="language-php">// SELECT `entry_key`, `entry_value`
//     FROM `sys_registry`
//     WHERE `entry_namespace` = &#039;my_extension&#039;
$resultRows = $this-&gt;connectionPool
  -&gt;getConnectionForTable(&#039;sys_registry&#039;)
  -&gt;select(
     [&#039;entry_key&#039;, &#039;entry_value&#039;],
     &#039;sys_registry&#039;,
     [&#039;entry_namespace&#039; =&gt; &#039;my_extension&#039;]
  );</code></pre>
            <p>Read how to instantiate a connection
with the connection pool.</p>
            <p>Arguments of the select() method:</p>
            
    
<ol>
    <li>The columns of the table which to select as an array. Required.</li>
    <li>The name of the table. Required.</li>
    <li>The select criteria as an array of key/value pairs. The key is the field
name, the value is the value. In SQL they are mapped in a WHERE
keyword combined with AND. Optional.</li>
    <li>The columns to group the results by as an array. In SQL they are mapped
in a GROUP BY keyword. Optional.</li>
    <li>An associative array of column name/sort directions pairs. In SQL they are
mapped in an ORDER BY keyword. Optional.</li>
    <li>The maximum number of rows to return. In SQL it is mapped in a LIMIT
keyword. Optional.</li>
    <li>The first result row to select (when used the maximum number of rows). In
SQL it is mapped in an OFFSET keyword. Optional.</li>
</ol>
            <p>In contrast to the other short-hand methods, -select() returns a
Result object ready for -fetchAssociative() to
get single rows or for -fetchAllAssociative() to get all rows at once.</p>
            <p>Remarks:</p>
            

<ul>
    <li>For non-trivial SELECT queries it is often better to switch to the
according method of the query builder
object.</li>
    <li>The restriction builder adds default
WHERE restrictions. If these restrictions do not match the query
requirements, it is necessary to switch to the QueryBuilder-select()
method for fine-grained WHERE manipulation.</li>
</ul>
            <a id="database-connection-last-insert-id"></a>
    </div>
<div class="section" id="lastinsertid">
    <h1>lastInsertId()</h1>
            <p>This method returns the uid of the last insert() statement. This is useful if the id is to be used
directly afterwards:</p>
            <pre><code class="language-php">$connection = $this-&gt;connectionPool-&gt;getConnectionForTable(&#039;pages&#039;);
$connection-&gt;insert(
    &#039;pages&#039;,
    [
        &#039;pid&#039; =&gt; 0,
        &#039;title&#039; =&gt; &#039;Home&#039;,
    ]
);
$pageUid = (int)$connection-&gt;lastInsertId(&#039;pages&#039;);</code></pre>
            <p>Read how to instantiate a connection
with the connection pool.</p>
            <p>Remarks:</p>
            

<ul>
    <li>-lastInsertId($tableName) takes the table name as first argument.
Although it is optional, you should always specify the table name for
Doctrine DBAL compatibility with engines like PostgreSQL.</li>
    <li>If the name of the auto increment field is not uid, the second
argument must be specified with the name of that field. For simple TYPO3
tables, uid is fine and the argument can be omitted.</li>
</ul>
            <a id="database-connection-create-query-builder"></a>
    </div>
<div class="section" id="createquerybuilder">
    <h1>createQueryBuilder()</h1>
            <p>The query builder should not be reused for
multiple different queries. However, sometimes it is convenient to first fetch a
connection object for a specific table and execute a simple query, and later
create a query builder for a more complex query from that connection object. The
usefulness of this method is limited, however, and at the time of writing no
good example could be found in the Core.</p>
            <p>The method can also be useful in loops to save some precious code characters:</p>
            <pre><code class="language-php">$connection = $this-&gt;connection-&gt;getConnectionForTable($myTable);
foreach ($someList as $aListValue) {
    $myResult = $connection-&gt;createQueryBuilder
        -&gt;select(&#039;something&#039;)
        -&gt;from(&#039;whatever&#039;)
        -&gt;where(...)
        -&gt;executeQuery()
        -&gt;fetchAllAssociative();
}</code></pre>
            <p>Read how to instantiate a connection
with the connection pool.</p>
    </div>

    </section>
                            </div>
            <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
        </div>
        <a href="guide/ApiOverview/Database/Connection/Index.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>